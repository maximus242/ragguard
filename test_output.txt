/Users/cloud/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
============================= test session starts ==============================
platform darwin -- Python 3.9.6, pytest-8.4.2, pluggy-1.6.0 -- /Applications/Xcode.app/Contents/Developer/usr/bin/python3
cachedir: .pytest_cache
rootdir: /Users/cloud/Programming/ragguard
configfile: pyproject.toml
plugins: asyncio-1.2.0, anyio-4.12.0, langsmith-0.4.37, cov-7.0.0
asyncio: mode=strict, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 1914 items / 2 skipped

tests/enterprise/test_google_workspace.py::test_google_workspace_resolver_get_user_groups SKIPPED) [  0%]
tests/enterprise/test_google_workspace.py::test_google_workspace_resolver_get_user_groups_pagination SKIPPED) [  0%]
tests/enterprise/test_google_workspace.py::test_google_workspace_resolver_get_user_info SKIPPED) [  0%]
tests/enterprise/test_google_workspace.py::test_google_workspace_resolver_check_file_permission_direct SKIPPED) [  0%]
tests/enterprise/test_google_workspace.py::test_google_workspace_resolver_check_file_permission_group SKIPPED) [  0%]
tests/enterprise/test_google_workspace.py::test_google_workspace_resolver_check_file_permission_domain SKIPPED) [  0%]
tests/enterprise/test_google_workspace.py::test_google_workspace_resolver_check_file_permission_anyone SKIPPED) [  0%]
tests/enterprise/test_google_workspace.py::test_google_workspace_resolver_caching SKIPPED) [  0%]
tests/enterprise/test_google_workspace.py::test_google_workspace_resolver_can_access SKIPPED) [  0%]
tests/enterprise/test_google_workspace.py::test_google_drive_permission_builder_qdrant SKIPPED) [  0%]
tests/enterprise/test_google_workspace.py::test_google_drive_permission_builder_pgvector SKIPPED) [  0%]
tests/enterprise/test_google_workspace.py::test_google_drive_permission_builder_no_access SKIPPED) [  0%]
tests/enterprise/test_google_workspace.py::test_google_cloud_iam_resolver_check_permission SKIPPED) [  0%]
tests/enterprise/test_google_workspace.py::test_google_cloud_iam_resolver_can_access SKIPPED) [  0%]
tests/enterprise/test_google_workspace.py::test_google_workspace_integration_with_retriever SKIPPED) [  0%]
tests/integration/test_concurrent_access.py::test_qdrant_concurrent_queries PASSED [  0%]
tests/integration/test_concurrent_access.py::test_chromadb_concurrent_queries PASSED [  0%]
tests/integration/test_concurrent_access.py::test_user_isolation_under_load PASSED [  0%]
tests/integration/test_cross_backend_consistency.py::test_cross_backend_consistency_engineering_user SKIPPEDo enable.) [  0%]
tests/integration/test_cross_backend_consistency.py::test_cross_backend_consistency_public_only SKIPPEDo enable.) [  1%]
tests/integration/test_cross_backend_consistency.py::test_cross_backend_consistency_no_access SKIPPEDo enable.) [  1%]
tests/integration/test_faiss_post_filtering.py::test_faiss_post_filtering_returns_correct_count PASSED [  1%]
tests/integration/test_faiss_post_filtering.py::test_faiss_post_filtering_no_leakage PASSED [  1%]
tests/integration/test_faiss_post_filtering.py::test_faiss_post_filtering_all_filtered_out PASSED [  1%]
tests/integration/test_faiss_post_filtering.py::test_faiss_post_filtering_guest_user PASSED [  1%]
tests/integration/test_faiss_post_filtering.py::test_faiss_post_filtering_performance PASSED [  1%]
tests/integration/test_faiss_post_filtering.py::test_faiss_handles_empty_index PASSED [  1%]
tests/integration/test_faiss_post_filtering.py::test_faiss_over_fetching_strategy PASSED [  1%]
tests/integration/test_graph_databases.py::TestNeo4jIntegration::test_department_filtering SKIPPED [  1%]
tests/integration/test_graph_databases.py::TestNeo4jIntegration::test_category_filtering SKIPPED [  1%]
tests/integration/test_graph_databases.py::TestNeo4jIntegration::test_admin_access SKIPPED [  1%]
tests/integration/test_graph_databases.py::TestNeo4jIntegration::test_relationship_traversal SKIPPED [  1%]
tests/integration/test_graph_databases.py::TestNeo4jIntegration::test_deny_all_when_no_rules_match SKIPPED [  1%]
tests/integration/test_graph_databases.py::TestArangoDBIntegration::test_department_filtering SKIPPED [  1%]
tests/integration/test_graph_databases.py::TestArangoDBIntegration::test_category_filtering SKIPPED [  1%]
tests/integration/test_graph_databases.py::TestArangoDBIntegration::test_admin_access SKIPPED [  1%]
tests/integration/test_graph_databases.py::TestArangoDBIntegration::test_relationship_traversal SKIPPED [  1%]
tests/integration/test_graph_databases.py::TestArangoDBIntegration::test_deny_all_when_no_rules_match SKIPPED [  1%]
tests/integration/test_graph_databases.py::TestArangoDBIntegration::test_aql_graph_query SKIPPED [  2%]
tests/integration/test_graph_databases.py::TestGraphBackendConsistency::test_same_policy_different_backends SKIPPED [  2%]
tests/integration/test_or_logic_real_databases.py::test_qdrant_or_logic_integration SKIPPEDo enable.) [  2%]
tests/integration/test_or_logic_real_databases.py::test_qdrant_complex_or_and_integration SKIPPEDo enable.) [  2%]
tests/integration/test_or_logic_real_databases.py::test_chromadb_or_logic_integration SKIPPEDo enable.) [  2%]
tests/integration/test_or_logic_real_databases.py::test_pgvector_or_logic_integration SKIPPEDo enable.) [  2%]
tests/integration/test_or_logic_real_databases.py::test_weaviate_or_logic_integration SKIPPEDo enable.) [  2%]
tests/integration/test_or_logic_real_databases.py::test_or_logic_performance_native_vs_post_filter SKIPPEDo enable.) [  2%]
tests/integration/test_real_databases.py::test_qdrant_integration PASSED [  2%]
tests/integration/test_real_databases.py::test_chromadb_integration PASSED [  2%]
tests/integration/test_real_databases.py::test_pgvector_integration PASSED [  2%]
tests/integration/test_real_databases.py::test_cross_backend_consistency PASSED [  2%]
tests/test_additional_coverage.py::TestPolicyEngineEdgeCases::test_policy_engine_basic PASSED [  2%]
tests/test_additional_coverage.py::TestPolicyEngineEdgeCases::test_policy_engine_evaluate_allow PASSED [  2%]
tests/test_additional_coverage.py::TestPolicyEngineEdgeCases::test_policy_engine_evaluate_deny PASSED [  2%]
tests/test_additional_coverage.py::TestPolicyEngineEdgeCases::test_policy_engine_with_roles PASSED [  2%]
tests/test_additional_coverage.py::TestPolicyEngineEdgeCases::test_policy_engine_to_filter PASSED [  2%]
tests/test_additional_coverage.py::TestPolicyCompilerEvaluator::test_evaluator_equals PASSED [  2%]
tests/test_additional_coverage.py::TestPolicyCompilerEvaluator::test_evaluator_not_equals PASSED [  2%]
tests/test_additional_coverage.py::TestPolicyCompilerEvaluator::test_evaluator_in_operator PASSED [  3%]
tests/test_additional_coverage.py::TestPolicyCompilerEvaluator::test_evaluator_comparison_operators PASSED [  3%]
tests/test_additional_coverage.py::TestPolicyCompilerEvaluator::test_evaluator_exists_operator PASSED [  3%]
tests/test_additional_coverage.py::TestPolicyCompilerEvaluator::test_evaluator_not_exists_operator PASSED [  3%]
tests/test_additional_coverage.py::TestFiltersBase::test_validate_field_name PASSED [  3%]
tests/test_additional_coverage.py::TestFiltersBase::test_validate_field_path PASSED [  3%]
tests/test_additional_coverage.py::TestFiltersBase::test_parse_literal_value PASSED [  3%]
tests/test_additional_coverage.py::TestFiltersBase::test_parse_list_literal PASSED [  3%]
tests/test_additional_coverage.py::TestFiltersBase::test_get_nested_value PASSED [  3%]
tests/test_additional_coverage.py::TestTypesModule::test_search_result_creation PASSED [  3%]
tests/test_additional_coverage.py::TestTypesModule::test_user_context_type PASSED [  3%]
tests/test_additional_coverage.py::TestCircuitBreaker::test_circuit_breaker_config PASSED [  3%]
tests/test_additional_coverage.py::TestCircuitBreaker::test_circuit_breaker_state_closed PASSED [  3%]
tests/test_additional_coverage.py::TestCircuitBreaker::test_circuit_breaker_opens_on_failures PASSED [  3%]
tests/test_additional_coverage.py::TestCircuitBreaker::test_circuit_breaker_success_resets PASSED [  3%]
tests/test_additional_coverage.py::TestFilterBackendEdgeCases::test_pgvector_rule_no_conditions PASSED [  3%]
tests/test_additional_coverage.py::TestFilterBackendEdgeCases::test_chromadb_user_field_equals_document_field PASSED [  3%]
tests/test_additional_coverage.py::TestFilterBackendEdgeCases::test_weaviate_user_in_document_list PASSED [  3%]
tests/test_additional_coverage.py::TestFilterBackendEdgeCases::test_pinecone_exists_operator PASSED [  3%]
tests/test_additional_coverage.py::TestFilterBackendEdgeCases::test_elasticsearch_not_in_operator PASSED [  4%]
tests/test_async_faiss_coverage.py::TestAsyncFAISSSecureRetriever::test_init_basic PASSED [  4%]
tests/test_async_faiss_coverage.py::TestAsyncFAISSSecureRetriever::test_init_with_embed_fn PASSED [  4%]
tests/test_async_faiss_coverage.py::TestAsyncFAISSSecureRetriever::test_init_with_over_fetch_factor PASSED [  4%]
tests/test_async_faiss_coverage.py::TestAsyncFAISSSecureRetriever::test_search_async PASSED [  4%]
tests/test_async_faiss_coverage.py::TestAsyncFAISSSecureRetriever::test_execute_search_not_implemented PASSED [  4%]
tests/test_async_faiss_coverage.py::TestAsyncFAISSSecureRetriever::test_backend_name PASSED [  4%]
tests/test_async_faiss_coverage.py::TestAsyncFAISSWithRetry::test_init_with_retry_config PASSED [  4%]
tests/test_async_faiss_coverage.py::TestAsyncFAISSWithRetry::test_init_with_retry_disabled PASSED [  4%]
tests/test_async_faiss_coverage.py::TestAsyncFAISSWithAuditLogger::test_init_with_audit_logger PASSED [  4%]
tests/test_async_retrievers.py::TestAsyncQdrantSecureRetriever::test_init_requires_async_client PASSED [  4%]
tests/test_async_retrievers.py::TestAsyncQdrantSecureRetriever::test_async_search_with_vector SKIPPED [  4%]
tests/test_async_retrievers.py::TestAsyncQdrantSecureRetriever::test_async_search_with_text_requires_embed_fn PASSED [  4%]
tests/test_async_retrievers.py::TestAsyncQdrantSecureRetriever::test_retry_disabled PASSED [  4%]
tests/test_async_retrievers.py::TestAsyncChromaDBSecureRetriever::test_async_search_with_text PASSED [  4%]
tests/test_async_retrievers.py::TestAsyncChromaDBSecureRetriever::test_async_search_with_vector PASSED [  4%]
tests/test_async_retrievers.py::TestAsyncChromaDBSecureRetriever::test_retry_config PASSED [  4%]
tests/test_async_retrievers.py::TestAsyncPineconeSecureRetriever::test_async_search_with_vector PASSED [  4%]
tests/test_async_retrievers.py::TestAsyncPineconeSecureRetriever::test_text_query_requires_embed_fn PASSED [  4%]
tests/test_async_retrievers.py::TestAsyncWeaviateSecureRetriever::test_async_search PASSED [  5%]
tests/test_async_retrievers.py::TestAsyncWeaviateSecureRetriever::test_retry_enabled PASSED [  5%]
tests/test_async_retrievers.py::TestAsyncPgvectorSecureRetriever::test_wraps_sync_retriever PASSED [  5%]
tests/test_async_retrievers.py::TestAsyncFAISSSecureRetriever::test_wraps_sync_retriever PASSED [  5%]
tests/test_async_retrievers.py::TestAsyncUtilities::test_run_sync_retriever_async PASSED [  5%]
tests/test_async_retrievers.py::TestAsyncUtilities::test_batch_search_async PASSED [  5%]
tests/test_async_retrievers.py::TestAsyncUtilities::test_multi_user_search_async PASSED [  5%]
tests/test_async_retrievers.py::TestEmbedFunctionHandling::test_embed_fn_called_in_executor PASSED [  5%]
tests/test_async_retrievers.py::TestRetryBehavior::test_retry_on_failure PASSED [  5%]
tests/test_async_retrievers.py::TestRetryBehavior::test_no_retry_when_disabled PASSED [  5%]
tests/test_audit_logger.py::test_audit_logger_stdout PASSED              [  5%]
tests/test_audit_logger.py::test_audit_logger_file PASSED                [  5%]
tests/test_audit_logger.py::test_audit_logger_callback PASSED            [  5%]
tests/test_audit_logger.py::test_audit_logger_additional_info PASSED     [  5%]
tests/test_audit_logger.py::test_null_audit_logger PASSED                [  5%]
tests/test_audit_logger.py::test_audit_logger_creates_parent_directory PASSED [  5%]
tests/test_azure_search_advanced.py::test_azure_search_health_check_success PASSED [  5%]
tests/test_azure_search_advanced.py::test_azure_search_context_manager PASSED [  5%]
tests/test_azure_search_advanced.py::test_azure_search_with_validation PASSED [  5%]
tests/test_azure_search_advanced.py::test_azure_search_with_retry PASSED [  6%]
tests/test_azure_search_advanced.py::test_azure_search_with_cache PASSED [  6%]
tests/test_azure_search_advanced.py::test_azure_search_with_audit_logging PASSED [  6%]
tests/test_azure_search_advanced.py::test_azure_search_search_failure PASSED [  6%]
tests/test_azure_search_advanced.py::test_azure_search_empty_results PASSED [  6%]
tests/test_azure_search_advanced.py::test_azure_search_batch_search PASSED [  6%]
tests/test_azure_search_advanced.py::test_azure_search_policy_update PASSED [  6%]
tests/test_azure_search_advanced.py::test_azure_search_with_embed_fn PASSED [  6%]
tests/test_azure_search_advanced.py::test_azure_search_text_query_without_embed_fn PASSED [  6%]
tests/test_azure_search_advanced.py::test_azure_cognitive_search_alias PASSED [  6%]
tests/test_azure_search_advanced.py::test_azure_search_with_custom_vector_field PASSED [  6%]
tests/test_azure_search_integration.py::test_azure_search_filter_builder PASSED [  6%]
tests/test_azure_search_integration.py::test_azure_search_filter_with_role PASSED [  6%]
tests/test_azure_search_integration.py::test_azure_search_filter_with_match PASSED [  6%]
tests/test_azure_search_integration.py::test_azure_search_filter_with_list_match PASSED [  6%]
tests/test_azure_search_integration.py::test_azure_search_filter_with_range PASSED [  6%]
tests/test_azure_search_integration.py::test_azure_search_filter_with_or PASSED [  6%]
tests/test_azure_search_integration.py::test_azure_search_filter_exists PASSED [  6%]
tests/test_azure_search_integration.py::test_azure_search_filter_not_exists PASSED [  6%]
tests/test_azure_search_integration.py::test_azure_search_filter_nested_field PASSED [  7%]
tests/test_azure_search_integration.py::test_azure_search_filter_value_in_array PASSED [  7%]
tests/test_azure_search_integration.py::test_azure_search_filter_not_in_array PASSED [  7%]
tests/test_azure_search_integration.py::test_azure_search_filter_with_in_operator PASSED [  7%]
tests/test_azure_search_integration.py::test_azure_search_filter_not_equals PASSED [  7%]
tests/test_azure_search_integration.py::test_azure_search_filter_string_escaping PASSED [  7%]
tests/test_azure_search_integration.py::test_azure_search_retriever_basic PASSED [  7%]
tests/test_azure_search_integration.py::test_azure_search_retriever_with_filter PASSED [  7%]
tests/test_azure_search_integration.py::test_azure_cognitive_search_alias PASSED [  7%]
tests/test_azure_search_integration.py::test_azure_search_retriever_invalid_client PASSED [  7%]
tests/test_base_retriever.py::test_base_retriever_string_query_without_embed_fn PASSED [  7%]
tests/test_base_retriever.py::test_base_retriever_filter_build_error PASSED [  7%]
tests/test_base_retriever.py::test_base_retriever_audit_logging_failure PASSED [  7%]
tests/test_base_retriever.py::test_base_retriever_with_custom_filter_builder PASSED [  7%]
tests/test_batch_operations.py::test_batch_search_basic PASSED           [  7%]
tests/test_batch_operations.py::test_batch_search_with_text_queries PASSED [  7%]
tests/test_batch_operations.py::test_batch_search_empty_queries PASSED   [  7%]
tests/test_batch_operations.py::test_batch_search_single_query PASSED    [  7%]
tests/test_batch_operations.py::test_batch_search_with_different_permissions PASSED [  7%]
tests/test_batch_operations.py::test_batch_search_preserves_order PASSED [  7%]
tests/test_batch_operations.py::test_batch_search_limit_per_query PASSED [  8%]
tests/test_bedrock_integration.py::test_bedrock_retriever_import PASSED  [  8%]
tests/test_bedrock_integration.py::test_bedrock_retriever_initialization PASSED [  8%]
tests/test_bedrock_integration.py::test_bedrock_retrieve_with_policy PASSED [  8%]
tests/test_bedrock_integration.py::test_bedrock_retrieve_different_department PASSED [  8%]
tests/test_bedrock_integration.py::test_bedrock_retrieve_no_policy PASSED [  8%]
tests/test_bedrock_integration.py::test_bedrock_retrieve_with_custom_config PASSED [  8%]
tests/test_bedrock_integration.py::test_bedrock_result_standardization PASSED [  8%]
tests/test_bedrock_integration.py::test_bedrock_audit_logging PASSED     [  8%]
tests/test_bedrock_integration.py::test_bedrock_async_retrieve PASSED    [  8%]
tests/test_bedrock_integration.py::test_bedrock_missing_boto3 PASSED     [  8%]
tests/test_cache_security.py::test_policy_change_invalidates_cache_via_hash PASSED [  8%]
tests/test_cache_security.py::test_user_role_change_gets_new_filter PASSED [  8%]
tests/test_cache_security.py::test_no_cross_user_cache_leakage PASSED    [  8%]
tests/test_cache_security.py::test_irrelevant_user_fields_dont_break_cache PASSED [  8%]
tests/test_cache_security.py::test_manual_policy_update_is_now_safe PASSED [  8%]
tests/test_cache_security.py::test_policy_hash_changes_on_rule_modification PASSED [  8%]
tests/test_cache_security.py::test_cache_thread_safety_no_corruption PASSED [  8%]
tests/test_chromadb_advanced.py::test_chromadb_health_check_success PASSED [  8%]
tests/test_chromadb_advanced.py::test_chromadb_context_manager PASSED    [  9%]
tests/test_chromadb_advanced.py::test_chromadb_with_validation PASSED    [  9%]
tests/test_chromadb_advanced.py::test_chromadb_with_retry PASSED         [  9%]
tests/test_chromadb_advanced.py::test_chromadb_with_cache PASSED         [  9%]
tests/test_chromadb_advanced.py::test_chromadb_with_audit_logging PASSED [  9%]
tests/test_chromadb_advanced.py::test_chromadb_search_failure PASSED     [  9%]
tests/test_chromadb_advanced.py::test_chromadb_empty_results PASSED      [  9%]
tests/test_chromadb_advanced.py::test_chromadb_batch_search PASSED       [  9%]
tests/test_chromadb_advanced.py::test_chromadb_policy_update PASSED      [  9%]
tests/test_chromadb_advanced.py::test_chromadb_with_embed_fn PASSED      [  9%]
tests/test_chromadb_advanced.py::test_chromadb_text_query_without_embed_fn PASSED [  9%]
tests/test_chromadb_native_or.py::test_chromadb_simple_or_filter PASSED  [  9%]
tests/test_chromadb_native_or.py::test_chromadb_simple_and_filter PASSED [  9%]
tests/test_chromadb_native_or.py::test_chromadb_nested_or_and PASSED     [  9%]
tests/test_chromadb_native_or.py::test_chromadb_three_way_or PASSED      [  9%]
tests/test_chromadb_native_or.py::test_chromadb_or_with_user_context PASSED [  9%]
tests/test_chromadb_native_or.py::test_chromadb_complex_nested PASSED    [  9%]
tests/test_chromadb_native_or.py::test_chromadb_backward_compat_simple_condition PASSED [  9%]
tests/test_chromadb_native_or.py::test_chromadb_or_with_field_existence PASSED [  9%]
tests/test_chromadb_native_or.py::test_chromadb_or_with_comparison PASSED [ 10%]
tests/test_chromadb_native_or.py::test_chromadb_or_with_array_operations PASSED [ 10%]
tests/test_chromadb_retriever.py::test_chromadb_retriever_initialization PASSED [ 10%]
tests/test_chromadb_retriever.py::test_chromadb_retriever_missing_dependency PASSED [ 10%]
tests/test_chromadb_retriever.py::test_chromadb_retriever_search_with_filter PASSED [ 10%]
tests/test_chromadb_retriever.py::test_chromadb_retriever_search_no_results PASSED [ 10%]
tests/test_chromadb_retriever.py::test_chromadb_retriever_search_error PASSED [ 10%]
tests/test_chromadb_retriever.py::test_chromadb_retriever_with_vector_query PASSED [ 10%]
tests/test_chromadb_retriever.py::test_chromadb_retriever_with_where_document PASSED [ 10%]
tests/test_chromadb_retriever.py::test_chromadb_retriever_admin_full_access PASSED [ 10%]
tests/test_circuit_breaker.py::TestCircuitBreakerBasic::test_initial_state_closed PASSED [ 10%]
tests/test_circuit_breaker.py::TestCircuitBreakerBasic::test_success_in_closed_keeps_closed PASSED [ 10%]
tests/test_circuit_breaker.py::TestCircuitBreakerBasic::test_failures_below_threshold_stays_closed PASSED [ 10%]
tests/test_circuit_breaker.py::TestCircuitBreakerBasic::test_failures_at_threshold_opens_circuit PASSED [ 10%]
tests/test_circuit_breaker.py::TestCircuitBreakerBasic::test_success_resets_failure_count PASSED [ 10%]
tests/test_circuit_breaker.py::TestCircuitBreakerOpen::test_check_raises_when_open PASSED [ 10%]
tests/test_circuit_breaker.py::TestCircuitBreakerOpen::test_stats_track_rejected_requests PASSED [ 10%]
tests/test_circuit_breaker.py::TestCircuitBreakerHalfOpen::test_timeout_transitions_to_half_open PASSED [ 10%]
tests/test_circuit_breaker.py::TestCircuitBreakerHalfOpen::test_success_in_half_open_closes_circuit PASSED [ 10%]
tests/test_circuit_breaker.py::TestCircuitBreakerHalfOpen::test_failure_in_half_open_reopens_circuit PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerHalfOpen::test_half_open_limits_concurrent_calls PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerReset::test_reset_closes_open_circuit PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerReset::test_reset_clears_counters PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerRegistry::test_get_circuit_breaker_creates_new PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerRegistry::test_get_circuit_breaker_returns_same_instance PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerRegistry::test_different_backends_get_different_breakers PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerRegistry::test_reset_all_circuit_breakers PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerStats::test_stats_snapshot_is_independent PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerStats::test_total_successes_tracked PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerThreadSafety::test_concurrent_failures PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerThreadSafety::test_concurrent_check_and_record PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerIntegration::test_retriever_with_circuit_breaker PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerIntegration::test_retriever_circuit_breaker_disabled PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerIntegration::test_retriever_opens_circuit_on_failures PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerIntegration::test_retriever_reset_circuit_breaker PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerIntegration::test_search_with_timeout_success PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerIntegration::test_search_with_timeout_expires PASSED [ 11%]
tests/test_circuit_breaker.py::TestCircuitBreakerIntegration::test_search_with_no_timeout PASSED [ 11%]
tests/test_cli.py::TestLoadJSON::test_load_json_from_file PASSED         [ 12%]
tests/test_cli.py::TestLoadJSON::test_load_json_from_string PASSED       [ 12%]
tests/test_cli.py::TestLoadJSON::test_load_json_invalid PASSED           [ 12%]
tests/test_cli.py::TestValidateCommand::test_validate_valid_policy PASSED [ 12%]
tests/test_cli.py::TestValidateCommand::test_validate_invalid_policy PASSED [ 12%]
tests/test_cli.py::TestTestCommand::test_test_policy_pass PASSED         [ 12%]
tests/test_cli.py::TestTestCommand::test_test_policy_deny PASSED         [ 12%]
tests/test_cli.py::TestExplainCommand::test_explain_allow PASSED         [ 12%]
tests/test_cli.py::TestExplainCommand::test_explain_deny PASSED          [ 12%]
tests/test_cli.py::TestShowCommand::test_show_policy PASSED              [ 12%]
tests/test_cli.py::TestShowCommand::test_show_invalid_policy PASSED      [ 12%]
tests/test_cli.py::TestFiltersCommand::test_filters_single_backend PASSED [ 12%]
tests/test_cli.py::TestFiltersCommand::test_filters_all_backends PASSED  [ 12%]
tests/test_cli.py::TestFiltersCommand::test_filters_from_file PASSED     [ 12%]
tests/test_cli.py::TestFiltersCommand::test_filters_invalid_policy PASSED [ 12%]
tests/test_cli.py::TestMainFunction::test_no_command PASSED              [ 12%]
tests/test_comprehensive_coverage.py::TestRAGGuardExceptions::test_ragguard_error_base PASSED [ 12%]
tests/test_comprehensive_coverage.py::TestRAGGuardExceptions::test_policy_errors PASSED [ 12%]
tests/test_comprehensive_coverage.py::TestRAGGuardExceptions::test_policy_evaluation_error PASSED [ 12%]
tests/test_comprehensive_coverage.py::TestRAGGuardExceptions::test_filter_build_error PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestRAGGuardExceptions::test_unsupported_condition_error PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestRAGGuardExceptions::test_retriever_connection_error PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestRAGGuardExceptions::test_retriever_timeout_error PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestRAGGuardExceptions::test_health_check_error PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestRAGGuardExceptions::test_backend_error PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestRAGGuardExceptions::test_rate_limit_error PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestRAGGuardExceptions::test_quota_exceeded_error PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestRAGGuardExceptions::test_retriever_permission_error PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestRAGGuardExceptions::test_configuration_error PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestRAGGuardExceptions::test_retryable_exceptions_set PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestRAGGuardExceptions::test_non_retryable_exceptions_set PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestPgvectorFilterBackend::test_to_pgvector_filter_no_matching_rules PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestPgvectorFilterBackend::test_to_pgvector_filter_default_allow PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestPgvectorFilterBackend::test_to_pgvector_filter_with_match PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestPgvectorFilterBackend::test_to_pgvector_filter_with_match_list PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestPgvectorFilterBackend::test_pgvector_legacy_exists_condition PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestPgvectorFilterBackend::test_pgvector_legacy_not_equals PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestPgvectorFilterBackend::test_pgvector_legacy_not_in PASSED [ 13%]
tests/test_comprehensive_coverage.py::TestPgvectorFilterBackend::test_pgvector_legacy_not_in_null_user_value PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestPgvectorFilterBackend::test_pgvector_legacy_in_condition PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestPgvectorFilterBackend::test_pgvector_compiled_greater_than PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestPgvectorFilterBackend::test_pgvector_compiled_not_equals PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestPgvectorFilterBackend::test_pgvector_compiled_not_in_with_list PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestPgvectorFilterBackend::test_pgvector_compiled_not_in_empty_list PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestPgvectorFilterBackend::test_pgvector_compiled_not_in_user_null PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestPgvectorFilterBackend::test_pgvector_compiled_comparison_operators PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestWeaviateFilterBackend::test_weaviate_compiled_not_equals PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestWeaviateFilterBackend::test_weaviate_compiled_in_with_list PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestWeaviateFilterBackend::test_weaviate_compiled_comparison_operators PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestWeaviateFilterBackend::test_weaviate_compiled_not_in PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestMilvusFilterBackend::test_milvus_compiled_not_equals PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestMilvusFilterBackend::test_milvus_compiled_in_with_list PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestMilvusFilterBackend::test_milvus_compiled_comparison_operators PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestPineconeFilterBackend::test_pinecone_compiled_not_equals PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestPineconeFilterBackend::test_pinecone_compiled_not_in PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestPineconeFilterBackend::test_pinecone_compiled_comparison_operators PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestQdrantFilterBackend::test_qdrant_compiled_not_equals PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestQdrantFilterBackend::test_qdrant_compiled_not_in PASSED [ 14%]
tests/test_comprehensive_coverage.py::TestQdrantFilterBackend::test_qdrant_compiled_comparison_operators PASSED [ 15%]
tests/test_comprehensive_coverage.py::TestElasticsearchFilterBackend::test_elasticsearch_compiled_not_equals PASSED [ 15%]
tests/test_comprehensive_coverage.py::TestElasticsearchFilterBackend::test_elasticsearch_compiled_comparison_operators PASSED [ 15%]
tests/test_comprehensive_coverage.py::TestChromaDBFilterBackend::test_chromadb_compiled_not_equals PASSED [ 15%]
tests/test_comprehensive_coverage.py::TestChromaDBFilterBackend::test_chromadb_compiled_not_in PASSED [ 15%]
tests/test_comprehensive_coverage.py::TestChromaDBFilterBackend::test_chromadb_compiled_comparison_operators PASSED [ 15%]
tests/test_comprehensive_coverage.py::TestIntegrationsInit::test_langchain_import_available SKIPPED [ 15%]
tests/test_comprehensive_coverage.py::TestIntegrationsInit::test_llama_index_import_available SKIPPED [ 15%]
tests/test_comprehensive_coverage.py::TestIntegrationsInit::test_langgraph_import_available SKIPPED [ 15%]
tests/test_comprehensive_coverage.py::TestIntegrationsInit::test_bedrock_import_available SKIPPED [ 15%]
tests/test_comprehensive_coverage.py::TestIntegrationsInit::test_mcp_import_available SKIPPED [ 15%]
tests/test_concurrent_cache.py::test_concurrent_cache_access PASSED      [ 15%]
tests/test_concurrent_cache.py::test_concurrent_cache_updates PASSED     [ 15%]
tests/test_concurrent_cache.py::test_concurrent_cache_eviction PASSED    [ 15%]
tests/test_concurrent_cache.py::test_cache_disabled_concurrent PASSED    [ 15%]
tests/test_condition_compiler.py::test_compile_equals_condition PASSED   [ 15%]
tests/test_condition_compiler.py::test_compile_not_equals_condition PASSED [ 15%]
tests/test_condition_compiler.py::test_compile_in_condition PASSED       [ 15%]
tests/test_condition_compiler.py::test_compile_not_in_condition PASSED   [ 15%]
tests/test_condition_compiler.py::test_compile_nested_field_paths PASSED [ 16%]
tests/test_condition_compiler.py::test_compile_literal_string_double_quotes PASSED [ 16%]
tests/test_condition_compiler.py::test_compile_literal_string_single_quotes PASSED [ 16%]
tests/test_condition_compiler.py::test_compile_literal_integer PASSED    [ 16%]
tests/test_condition_compiler.py::test_compile_literal_float PASSED      [ 16%]
tests/test_condition_compiler.py::test_compile_literal_bool_true PASSED  [ 16%]
tests/test_condition_compiler.py::test_compile_literal_bool_false PASSED [ 16%]
tests/test_condition_compiler.py::test_compile_literal_none PASSED       [ 16%]
tests/test_condition_compiler.py::test_compile_whitespace_handling PASSED [ 16%]
tests/test_condition_compiler.py::test_compile_invalid_operator PASSED   [ 16%]
tests/test_condition_compiler.py::test_evaluate_equals_condition_match PASSED [ 16%]
tests/test_condition_compiler.py::test_evaluate_equals_condition_mismatch PASSED [ 16%]
tests/test_condition_compiler.py::test_evaluate_equals_condition_none_security PASSED [ 16%]
tests/test_condition_compiler.py::test_evaluate_not_equals_condition PASSED [ 16%]
tests/test_condition_compiler.py::test_evaluate_not_equals_condition_with_none PASSED [ 16%]
tests/test_condition_compiler.py::test_evaluate_in_condition_match PASSED [ 16%]
tests/test_condition_compiler.py::test_evaluate_in_condition_mismatch PASSED [ 16%]
tests/test_condition_compiler.py::test_evaluate_in_condition_not_a_list PASSED [ 16%]
tests/test_condition_compiler.py::test_evaluate_not_in_condition PASSED  [ 16%]
tests/test_condition_compiler.py::test_evaluate_nested_field_paths PASSED [ 17%]
tests/test_condition_compiler.py::test_evaluate_nested_field_missing PASSED [ 17%]
tests/test_condition_compiler.py::test_evaluate_literal_string PASSED    [ 17%]
tests/test_condition_compiler.py::test_evaluate_literal_number PASSED    [ 17%]
tests/test_condition_compiler.py::test_evaluate_literal_bool PASSED      [ 17%]
tests/test_condition_compiler.py::test_policy_engine_uses_compiled_conditions PASSED [ 17%]
tests/test_condition_compiler.py::test_policy_engine_multiple_conditions PASSED [ 17%]
tests/test_condition_compiler.py::test_policy_engine_compiled_vs_string_parsing PASSED [ 17%]
tests/test_condition_compiler.py::test_policy_engine_compilation_error_handling PASSED [ 17%]
tests/test_condition_compiler.py::test_policy_engine_no_conditions PASSED [ 17%]
tests/test_condition_compiler.py::test_compiled_conditions_are_faster PASSED [ 17%]
tests/test_config.py::TestSecureRetrieverConfigDefaults::test_default_values PASSED [ 17%]
tests/test_config.py::TestSecureRetrieverConfigDefaults::test_default_nested_configs_created PASSED [ 17%]
tests/test_config.py::TestSecureRetrieverConfigPresets::test_development_preset PASSED [ 17%]
tests/test_config.py::TestSecureRetrieverConfigPresets::test_production_preset PASSED [ 17%]
tests/test_config.py::TestSecureRetrieverConfigPresets::test_strict_preset PASSED [ 17%]
tests/test_config.py::TestSecureRetrieverConfigPresets::test_minimal_preset PASSED [ 17%]
tests/test_config.py::TestSecureRetrieverConfigFluentAPI::test_with_validation PASSED [ 17%]
tests/test_config.py::TestSecureRetrieverConfigFluentAPI::test_with_validation_multiple_params PASSED [ 17%]
tests/test_config.py::TestSecureRetrieverConfigFluentAPI::test_with_retry PASSED [ 18%]
tests/test_config.py::TestSecureRetrieverConfigFluentAPI::test_with_retry_multiple_params PASSED [ 18%]
tests/test_config.py::TestSecureRetrieverConfigFluentAPI::test_with_cache PASSED [ 18%]
tests/test_config.py::TestSecureRetrieverConfigFluentAPI::test_with_audit_enabled PASSED [ 18%]
tests/test_config.py::TestSecureRetrieverConfigFluentAPI::test_with_audit_disabled PASSED [ 18%]
tests/test_config.py::TestSecureRetrieverConfigFluentAPI::test_chained_modifications PASSED [ 18%]
tests/test_config.py::TestSecureRetrieverConfigImmutability::test_with_validation_returns_new_instance PASSED [ 18%]
tests/test_config.py::TestSecureRetrieverConfigImmutability::test_with_retry_returns_new_instance PASSED [ 18%]
tests/test_config.py::TestSecureRetrieverConfigImmutability::test_with_cache_returns_new_instance PASSED [ 18%]
tests/test_config.py::TestSecureRetrieverConfigImmutability::test_with_audit_returns_new_instance PASSED [ 18%]
tests/test_config.py::TestSecureRetrieverConfigImport::test_import_from_ragguard PASSED [ 18%]
tests/test_config.py::TestSecureRetrieverConfigImport::test_in_all_exports PASSED [ 18%]
tests/test_connection_pool.py::test_managed_connection_with_direct_connection PASSED [ 18%]
tests/test_connection_pool.py::test_managed_connection_with_pool PASSED  [ 18%]
tests/test_connection_pool.py::test_managed_connection_context_manager PASSED [ 18%]
tests/test_connection_pool.py::test_pgvector_pool_psycopg2_creation PASSED [ 18%]
tests/test_connection_pool.py::test_pgvector_pool_psycopg3_creation PASSED [ 18%]
tests/test_connection_pool.py::test_pgvector_pool_invalid_driver PASSED  [ 18%]
tests/test_connection_pool.py::test_pgvector_pool_getconn_psycopg2 PASSED [ 18%]
tests/test_connection_pool.py::test_pgvector_pool_putconn_psycopg2 PASSED [ 19%]
tests/test_connection_pool.py::test_pgvector_pool_context_manager PASSED [ 19%]
tests/test_connection_pool.py::test_pgvector_pool_get_connection_context PASSED [ 19%]
tests/test_connection_pool.py::test_pgvector_pool_close PASSED           [ 19%]
tests/test_connection_pool.py::test_pgvector_pool_getconn_after_close PASSED [ 19%]
tests/test_connection_pool.py::test_pgvector_retriever_with_pool PASSED  [ 19%]
tests/test_connection_pool.py::test_pgvector_retriever_with_direct_connection PASSED [ 19%]
tests/test_constants.py::TestFieldPrefixes::test_user_prefix PASSED      [ 19%]
tests/test_constants.py::TestFieldPrefixes::test_document_prefix PASSED  [ 19%]
tests/test_constants.py::TestSecurityLimits::test_limits_are_reasonable PASSED [ 19%]
tests/test_constants.py::TestCacheDefaults::test_cache_size PASSED       [ 19%]
tests/test_constants.py::TestSentinelValues::test_sentinel_values_distinct PASSED [ 19%]
tests/test_constants.py::TestSentinelValues::test_skip_rule_is_singleton PASSED [ 19%]
tests/test_constants.py::TestSentinelValues::test_skip_rule_is_distinct_from_none PASSED [ 19%]
tests/test_constants.py::TestSentinelValues::test_skip_rule_repr PASSED  [ 19%]
tests/test_constants.py::TestSentinelValues::test_skip_rule_identity PASSED [ 19%]
tests/test_constants.py::TestOperators::test_equality_operators PASSED   [ 19%]
tests/test_constants.py::TestOperators::test_membership_operators PASSED [ 19%]
tests/test_constants.py::TestOperators::test_all_operators_contains_common_ops PASSED [ 19%]
tests/test_constants.py::TestOperators::test_binary_vs_unary PASSED      [ 20%]
tests/test_constants.py::TestBackends::test_backend_names PASSED         [ 20%]
tests/test_constants.py::TestBackends::test_all_backends_not_empty PASSED [ 20%]
tests/test_constants.py::TestBackends::test_native_vs_post_filter PASSED [ 20%]
tests/test_constants.py::TestBackends::test_all_backends_covered PASSED  [ 20%]
tests/test_context_manager.py::test_base_retriever_context_manager PASSED [ 20%]
tests/test_context_manager.py::test_context_manager_with_exception PASSED [ 20%]
tests/test_context_manager.py::test_context_manager_without_close_method PASSED [ 20%]
tests/test_context_manager.py::test_context_manager_with_failing_close PASSED [ 20%]
tests/test_context_manager.py::test_context_manager_with_audit_logger PASSED [ 20%]
tests/test_context_manager.py::test_pgvector_context_manager_with_pool PASSED [ 20%]
tests/test_context_manager.py::test_chromadb_context_manager PASSED      [ 20%]
tests/test_context_manager.py::test_manual_cleanup_still_works PASSED    [ 20%]
tests/test_crash_scenarios.py::test_none_user_context PASSED             [ 20%]
tests/test_crash_scenarios.py::test_empty_user_dict PASSED               [ 20%]
tests/test_crash_scenarios.py::test_user_with_none_roles PASSED          [ 20%]
tests/test_crash_scenarios.py::test_user_missing_required_field PASSED   [ 20%]
tests/test_crash_scenarios.py::test_roles_as_string_not_list PASSED      [ 20%]
tests/test_crash_scenarios.py::test_very_large_user_context PASSED       [ 20%]
tests/test_crash_scenarios.py::test_circular_reference_in_user PASSED    [ 21%]
tests/test_crash_scenarios.py::test_unicode_in_user_fields PASSED        [ 21%]
tests/test_crash_scenarios.py::test_deep_nesting_in_condition PASSED     [ 21%]
tests/test_crash_scenarios.py::test_sql_injection_in_condition PASSED    [ 21%]
tests/test_crash_scenarios.py::test_code_injection_attempt PASSED        [ 21%]
tests/test_crash_scenarios.py::test_collection_not_found PASSED          [ 21%]
tests/test_crash_scenarios.py::test_wrong_vector_dimension PASSED        [ 21%]
tests/test_crash_scenarios.py::test_text_query_without_embed_fn PASSED   [ 21%]
tests/test_crash_scenarios.py::test_negative_limit PASSED                [ 21%]
tests/test_crash_scenarios.py::test_nonexistent_policy_file PASSED       [ 21%]
tests/test_crash_scenarios.py::test_empty_yaml_file PASSED               [ 21%]
tests/test_crash_scenarios.py::test_malformed_yaml PASSED                [ 21%]
tests/test_crash_scenarios.py::test_audit_log_permission_denied PASSED   [ 21%]
tests/test_crash_scenarios.py::test_audit_log_raise_on_failure PASSED    [ 21%]
tests/test_crash_scenarios.py::test_audit_log_on_failure_callback PASSED [ 21%]
tests/test_crash_scenarios.py::test_policy_empty_rules PASSED            [ 21%]
tests/test_crash_scenarios.py::test_policy_invalid_default PASSED        [ 21%]
tests/test_crash_scenarios.py::test_policy_invalid_condition_operator PASSED [ 21%]
tests/test_crash_scenarios.py::test_concurrent_searches PASSED           [ 21%]
tests/test_crash_scenarios.py::test_concurrent_audit_logging PASSED      [ 21%]
tests/test_crash_scenarios.py::test_custom_filter_returns_none PASSED    [ 22%]
tests/test_crash_scenarios.py::test_custom_filter_raises_exception PASSED [ 22%]
tests/test_crewai_coverage.py::TestCheckCrewAIAvailable::test_crewai_available PASSED [ 22%]
tests/test_crewai_coverage.py::TestCheckCrewAIAvailable::test_crewai_not_available PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolInit::test_init_with_retriever PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolInit::test_init_with_qdrant_params PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolInit::test_init_missing_params PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolInit::test_init_with_custom_description PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolInit::test_init_with_audit_logger PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolUserContext::test_set_user PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolUserContext::test_get_user_none PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolUserContext::test_set_user_chaining PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolRun::test_run_without_user_raises PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolRun::test_run_with_payload_result PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolRun::test_run_with_dict_result PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolRun::test_run_with_content_field PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolRun::test_run_with_empty_results PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolRun::test_run_with_fallback_result_format PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolRun::test_run_truncates_long_content PASSED [ 22%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolRun::test_run_search_exception PASSED [ 23%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolRun::test_run_with_empty_payload PASSED [ 23%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolRun::test_run_multiple_results PASSED [ 23%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolDictResults::test_dict_with_nested_metadata PASSED [ 23%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolDictResults::test_dict_with_content_field PASSED [ 23%]
tests/test_crewai_coverage.py::TestSecureRetrieverToolDictResults::test_dict_without_score PASSED [ 23%]
tests/test_crewai_coverage.py::TestSecureRAGTool::test_default_name_and_description PASSED [ 23%]
tests/test_crewai_coverage.py::TestSecureRAGTool::test_inherits_from_secure_retriever_tool PASSED [ 23%]
tests/test_crewai_coverage.py::TestCreateSecureRetrieverTool::test_basic_creation PASSED [ 23%]
tests/test_crewai_coverage.py::TestCreateSecureRetrieverTool::test_creation_with_user PASSED [ 23%]
tests/test_crewai_coverage.py::TestCreateSecureRetrieverTool::test_creation_without_user PASSED [ 23%]
tests/test_crewai_coverage.py::TestCreateSecureRetrieverTool::test_default_values PASSED [ 23%]
tests/test_crewai_coverage.py::TestSecureSearchInput::test_schema_fields PASSED [ 23%]
tests/test_crewai_coverage.py::TestModuleExports::test_all_exports PASSED [ 23%]
tests/test_custom_filters.py::test_acl_filter_builder_qdrant PASSED      [ 23%]
tests/test_custom_filters.py::test_acl_filter_builder_pgvector PASSED    [ 23%]
tests/test_custom_filters.py::test_acl_filter_builder_no_user PASSED     [ 23%]
tests/test_custom_filters.py::test_acl_filter_builder_public_access PASSED [ 23%]
tests/test_custom_filters.py::test_lambda_filter_builder_qdrant PASSED   [ 23%]
tests/test_custom_filters.py::test_lambda_filter_builder_pgvector PASSED [ 24%]
tests/test_custom_filters.py::test_lambda_filter_builder_no_handler PASSED [ 24%]
tests/test_custom_filters.py::test_lambda_filter_builder_multiple_conditions PASSED [ 24%]
tests/test_custom_filters.py::test_hybrid_filter_builder_qdrant PASSED   [ 24%]
tests/test_custom_filters.py::test_hybrid_filter_builder_no_additional_filters PASSED [ 24%]
tests/test_custom_filters.py::test_field_mapping_filter_builder_basic PASSED [ 24%]
tests/test_custom_filters.py::test_field_mapping_filter_builder_with_transforms PASSED [ 24%]
tests/test_custom_filters.py::test_field_mapping_filter_builder_multiple_mappings PASSED [ 24%]
tests/test_custom_filters.py::test_field_mapping_filter_builder_pgvector PASSED [ 24%]
tests/test_custom_filters.py::test_custom_filter_builder_unsupported_backend PASSED [ 24%]
tests/test_custom_filters.py::test_custom_filter_builder_empty_groups PASSED [ 24%]
tests/test_custom_filters.py::test_lambda_filter_builder_none_return PASSED [ 24%]
tests/test_custom_filters_complete.py::test_field_mapping_filter_builder_unsupported_backend PASSED [ 24%]
tests/test_custom_filters_complete.py::test_acl_filter_builder_missing_qdrant_client PASSED [ 24%]
tests/test_custom_filters_complete.py::test_hybrid_filter_builder_unsupported_backend PASSED [ 24%]
tests/test_custom_filters_complete.py::test_hybrid_filter_builder_combine_qdrant_filter1_none PASSED [ 24%]
tests/test_custom_filters_complete.py::test_hybrid_filter_builder_combine_qdrant_filter2_none PASSED [ 24%]
tests/test_custom_filters_complete.py::test_hybrid_filter_builder_combine_qdrant_both_filters PASSED [ 24%]
tests/test_custom_filters_complete.py::test_hybrid_filter_builder_pgvector PASSED [ 24%]
tests/test_custom_filters_complete.py::test_hybrid_filter_builder_pgvector_filter1_empty PASSED [ 25%]
tests/test_custom_filters_complete.py::test_hybrid_filter_builder_pgvector_filter2_empty PASSED [ 25%]
tests/test_custom_filters_complete.py::test_hybrid_filter_builder_pgvector_both_filters PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_health_check_success PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_health_check_connection_failed PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_health_check_index_missing PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_context_manager PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_with_validation PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_with_retry PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_with_cache PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_with_audit_logging PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_search_failure PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_empty_results PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_with_custom_num_candidates PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_with_source_fields PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_opensearch_health_check PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_batch_search PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_policy_update PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_invalidate_cache PASSED [ 25%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_with_embed_fn PASSED [ 26%]
tests/test_elasticsearch_advanced.py::test_elasticsearch_text_query_without_embed_fn PASSED [ 26%]
tests/test_elasticsearch_integration.py::test_elasticsearch_filter_builder PASSED [ 26%]
tests/test_elasticsearch_integration.py::test_elasticsearch_filter_with_role PASSED [ 26%]
tests/test_elasticsearch_integration.py::test_elasticsearch_filter_with_match PASSED [ 26%]
tests/test_elasticsearch_integration.py::test_elasticsearch_filter_with_list_match PASSED [ 26%]
tests/test_elasticsearch_integration.py::test_elasticsearch_filter_with_range PASSED [ 26%]
tests/test_elasticsearch_integration.py::test_elasticsearch_filter_with_or PASSED [ 26%]
tests/test_elasticsearch_integration.py::test_elasticsearch_filter_exists PASSED [ 26%]
tests/test_elasticsearch_integration.py::test_elasticsearch_retriever_basic PASSED [ 26%]
tests/test_elasticsearch_integration.py::test_elasticsearch_retriever_with_filter PASSED [ 26%]
tests/test_elasticsearch_integration.py::test_opensearch_retriever_alias PASSED [ 26%]
tests/test_elasticsearch_integration.py::test_elasticsearch_retriever_invalid_client PASSED [ 26%]
tests/test_elasticsearch_integration.py::test_elasticsearch_filter_with_nested_field PASSED [ 26%]
tests/test_elasticsearch_integration.py::test_elasticsearch_filter_not_equals PASSED [ 26%]
tests/test_elasticsearch_integration.py::test_elasticsearch_filter_with_in_operator PASSED [ 26%]
tests/test_error_messages.py::test_error_context_basic PASSED            [ 26%]
tests/test_error_messages.py::test_error_context_with_attempted_value PASSED [ 26%]
tests/test_error_messages.py::test_error_context_with_valid_options PASSED [ 26%]
tests/test_error_messages.py::test_error_context_with_suggestions PASSED [ 27%]
tests/test_error_messages.py::test_error_context_with_context_info PASSED [ 27%]
tests/test_error_messages.py::test_error_context_with_doc_link PASSED    [ 27%]
tests/test_error_messages.py::test_unsupported_backend_error PASSED      [ 27%]
tests/test_error_messages.py::test_missing_dependency_error PASSED       [ 27%]
tests/test_error_messages.py::test_validation_error PASSED               [ 27%]
tests/test_error_messages.py::test_policy_compilation_error PASSED       [ 27%]
tests/test_error_messages.py::test_connection_error PASSED               [ 27%]
tests/test_error_messages.py::test_filter_generation_error PASSED        [ 27%]
tests/test_error_messages.py::test_empty_user_context_error PASSED       [ 27%]
tests/test_error_messages.py::test_field_not_found_error PASSED          [ 27%]
tests/test_error_messages.py::test_policy_engine_unsupported_backend_error PASSED [ 27%]
tests/test_error_messages.py::test_validator_empty_user_context_error PASSED [ 27%]
tests/test_error_messages.py::test_error_message_formatting PASSED       [ 27%]
tests/test_error_messages.py::test_error_context_chaining PASSED         [ 27%]
tests/test_explainer.py::test_explainer_basic_allow PASSED               [ 27%]
tests/test_explainer.py::test_explainer_basic_deny PASSED                [ 27%]
tests/test_explainer.py::test_explainer_role_based_allow PASSED          [ 27%]
tests/test_explainer.py::test_explainer_role_based_deny PASSED           [ 27%]
tests/test_explainer.py::test_explainer_everyone_access PASSED           [ 28%]
tests/test_explainer.py::test_explainer_match_condition PASSED           [ 28%]
tests/test_explainer.py::test_explainer_multiple_conditions PASSED       [ 28%]
tests/test_explainer.py::test_explainer_multiple_rules PASSED            [ 28%]
tests/test_explainer.py::test_explainer_no_matching_rules PASSED         [ 28%]
tests/test_explainer.py::test_explainer_string_formatting PASSED         [ 28%]
tests/test_explainer.py::test_explainer_comparison_operators PASSED      [ 28%]
tests/test_explainer.py::test_explainer_in_operator PASSED               [ 28%]
tests/test_explainer.py::test_explainer_nested_fields PASSED             [ 28%]
tests/test_explainer.py::test_explainer_document_id_override PASSED      [ 28%]
tests/test_explainer.py::test_explainer_value_extraction PASSED          [ 28%]
tests/test_explainer.py::test_explainer_no_allow_conditions PASSED       [ 28%]
tests/test_expression_depth_limit.py::test_expression_depth_at_limit PASSED [ 28%]
tests/test_expression_depth_limit.py::test_expression_depth_one_below_limit PASSED [ 28%]
tests/test_expression_depth_limit.py::test_expression_depth_simple_condition PASSED [ 28%]
tests/test_expression_depth_limit.py::test_expression_depth_and_or_chains PASSED [ 28%]
tests/test_expression_depth_limit.py::test_expression_depth_mixed_nesting PASSED [ 28%]
tests/test_expression_depth_limit.py::test_expression_depth_exceeds_limit_by_one PASSED [ 28%]
tests/test_expression_depth_limit.py::test_expression_depth_far_exceeds_limit PASSED [ 28%]
tests/test_expression_depth_limit.py::test_expression_depth_limit_value PASSED [ 28%]
tests/test_expression_depth_limit.py::test_expression_depth_error_message PASSED [ 29%]
tests/test_expression_depth_limit.py::test_expression_depth_with_list_literals PASSED [ 29%]
tests/test_expression_depth_limit.py::test_expression_depth_boundary_cases PASSED [ 29%]
tests/test_faiss_advanced.py::test_faiss_health_check_success PASSED     [ 29%]
tests/test_faiss_advanced.py::test_faiss_context_manager PASSED          [ 29%]
tests/test_faiss_advanced.py::test_faiss_with_validation PASSED          [ 29%]
tests/test_faiss_advanced.py::test_faiss_with_retry PASSED               [ 29%]
tests/test_faiss_advanced.py::test_faiss_with_cache PASSED               [ 29%]
tests/test_faiss_advanced.py::test_faiss_with_audit_logging PASSED       [ 29%]
tests/test_faiss_advanced.py::test_faiss_search_failure PASSED           [ 29%]
tests/test_faiss_advanced.py::test_faiss_empty_results PASSED            [ 29%]
tests/test_faiss_advanced.py::test_faiss_batch_search PASSED             [ 29%]
tests/test_faiss_advanced.py::test_faiss_policy_update PASSED            [ 29%]
tests/test_faiss_advanced.py::test_faiss_over_fetch_factor PASSED        [ 29%]
tests/test_faiss_retriever.py::test_faiss_retriever_initialization PASSED [ 29%]
tests/test_faiss_retriever.py::test_faiss_retriever_missing_dependency PASSED [ 29%]
tests/test_faiss_retriever.py::test_faiss_retriever_search_with_filter PASSED [ 29%]
tests/test_faiss_retriever.py::test_faiss_retriever_insufficient_results PASSED [ 29%]
tests/test_faiss_retriever.py::test_faiss_retriever_padding_indices PASSED [ 29%]
tests/test_faiss_retriever.py::test_faiss_retriever_missing_metadata PASSED [ 30%]
tests/test_faiss_retriever.py::test_faiss_retriever_with_vector_query PASSED [ 30%]
tests/test_faiss_retriever.py::test_faiss_retriever_over_fetch_limit PASSED [ 30%]
tests/test_faiss_retriever.py::test_faiss_retriever_search_error PASSED  [ 30%]
tests/test_faiss_retriever.py::test_faiss_retriever_score_conversion PASSED [ 30%]
tests/test_faiss_retriever.py::test_faiss_retriever_min_over_fetch_factor PASSED [ 30%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field'; DROP TABLE--] PASSED [ 30%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field"; DELETE FROM] PASSED [ 30%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field`; rm -rf] PASSED [ 30%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field; SELECT * FROM] PASSED [ 30%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field' OR '1'='1] PASSED [ 30%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field AND 1=1--] PASSED [ 30%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[../../../etc/passwd] PASSED [ 30%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[..\\..\\..\\windows\\system32] PASSED [ 30%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field/../secret] PASSED [ 30%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field$(whoami)] PASSED [ 30%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field`id`] PASSED [ 30%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field|cat /etc/passwd] PASSED [ 30%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field;id] PASSED [ 30%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field'value] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field"value] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field`value] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field\x00null] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field\nvalue] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field\rvalue] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field\tvalue] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field\x00value] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[   ] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[\t\n] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[123field] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[-field] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[.field0] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[@field] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[$field] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[.field1] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field.] PASSED [ 31%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[field..name] PASSED [ 32%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_malicious_field_names[..field] PASSED [ 32%]
tests/test_field_injection.py::TestValidateFieldName::test_accepts_valid_simple_field PASSED [ 32%]
tests/test_field_injection.py::TestValidateFieldName::test_accepts_valid_dotted_field PASSED [ 32%]
tests/test_field_injection.py::TestValidateFieldName::test_rejects_none_and_non_string PASSED [ 32%]
tests/test_field_injection.py::TestValidateFieldPath::test_rejects_malicious_path_components[field'; DROP TABLE--] PASSED [ 32%]
tests/test_field_injection.py::TestValidateFieldPath::test_rejects_malicious_path_components[field"; DELETE FROM] PASSED [ 32%]
tests/test_field_injection.py::TestValidateFieldPath::test_rejects_malicious_path_components[../../../etc/passwd] PASSED [ 32%]
tests/test_field_injection.py::TestValidateFieldPath::test_rejects_malicious_path_components[field$(whoami)] PASSED [ 32%]
tests/test_field_injection.py::TestValidateFieldPath::test_rejects_malicious_path_components[field'value] PASSED [ 32%]
tests/test_field_injection.py::TestValidateFieldPath::test_rejects_malicious_path_components[] PASSED [ 32%]
tests/test_field_injection.py::TestValidateFieldPath::test_rejects_malicious_path_components[123field] PASSED [ 32%]
tests/test_field_injection.py::TestValidateFieldPath::test_rejects_malicious_path_components[aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa] PASSED [ 32%]
tests/test_field_injection.py::TestValidateFieldPath::test_accepts_valid_field_path PASSED [ 32%]
tests/test_field_injection.py::TestValidateFieldPath::test_rejects_empty_path PASSED [ 32%]
tests/test_field_injection.py::TestValidateFieldPath::test_accepts_tuple_field_path PASSED [ 32%]
tests/test_field_injection.py::TestPgvectorFieldInjection::test_compiled_conditions_reject_malicious_fields[field'; DROP TABLE--] PASSED [ 32%]
tests/test_field_injection.py::TestPgvectorFieldInjection::test_compiled_conditions_reject_malicious_fields[field"; DELETE FROM] PASSED [ 32%]
tests/test_field_injection.py::TestPgvectorFieldInjection::test_compiled_conditions_reject_malicious_fields[../../../etc/passwd] PASSED [ 32%]
tests/test_field_injection.py::TestPgvectorFieldInjection::test_compiled_conditions_reject_malicious_fields[field$(whoami)] PASSED [ 33%]
tests/test_field_injection.py::TestElasticsearchFieldInjection::test_rejects_malicious_field_paths[field'; DROP TABLE--] PASSED [ 33%]
tests/test_field_injection.py::TestElasticsearchFieldInjection::test_rejects_malicious_field_paths[../../../etc/passwd] PASSED [ 33%]
tests/test_field_injection.py::TestElasticsearchFieldInjection::test_rejects_malicious_field_paths[field$(whoami)] PASSED [ 33%]
tests/test_field_injection.py::TestAzureSearchFieldInjection::test_rejects_malicious_field_paths[field'; DROP TABLE--] PASSED [ 33%]
tests/test_field_injection.py::TestAzureSearchFieldInjection::test_rejects_malicious_field_paths[../../../etc/passwd] PASSED [ 33%]
tests/test_field_injection.py::TestAzureSearchFieldInjection::test_rejects_malicious_field_paths[field$(whoami)] PASSED [ 33%]
tests/test_field_injection.py::TestMilvusFieldInjection::test_rejects_malicious_field_names[field'; DROP TABLE--] PASSED [ 33%]
tests/test_field_injection.py::TestMilvusFieldInjection::test_rejects_malicious_field_names[../../../etc/passwd] PASSED [ 33%]
tests/test_field_injection.py::TestMilvusFieldInjection::test_rejects_malicious_field_names[field$(whoami)] PASSED [ 33%]
tests/test_field_injection.py::TestEdgeCases::test_field_with_underscore PASSED [ 33%]
tests/test_field_injection.py::TestEdgeCases::test_field_with_numbers PASSED [ 33%]
tests/test_field_injection.py::TestEdgeCases::test_mixed_case_fields PASSED [ 33%]
tests/test_field_injection.py::TestEdgeCases::test_max_length_enforcement PASSED [ 33%]
tests/test_field_injection.py::TestEdgeCases::test_path_component_length PASSED [ 33%]
tests/test_filter_builder.py::TestQdrantFilterBuilder::test_build_everyone_filter PASSED [ 33%]
tests/test_filter_builder.py::TestQdrantFilterBuilder::test_build_role_filter PASSED [ 33%]
tests/test_filter_builder.py::TestQdrantFilterBuilder::test_build_department_condition_filter PASSED [ 33%]
tests/test_filter_builder.py::TestQdrantFilterBuilder::test_build_multiple_rules_or_logic PASSED [ 33%]
tests/test_filter_builder.py::TestQdrantFilterBuilder::test_build_no_matching_rules_deny PASSED [ 34%]
tests/test_filter_builder.py::TestPgvectorFilterBuilder::test_build_everyone_filter PASSED [ 34%]
tests/test_filter_builder.py::TestPgvectorFilterBuilder::test_build_role_filter PASSED [ 34%]
tests/test_filter_builder.py::TestPgvectorFilterBuilder::test_build_department_condition_filter PASSED [ 34%]
tests/test_filter_builder.py::TestPgvectorFilterBuilder::test_build_no_matching_rules_deny PASSED [ 34%]
tests/test_filter_builder.py::TestPgvectorFilterBuilder::test_build_multiple_rules_or_logic PASSED [ 34%]
tests/test_filter_builder.py::TestPgvectorFilterBuilder::test_sql_injection_protection PASSED [ 34%]
tests/test_filter_builder_complete.py::test_to_qdrant_filter_missing_dependency PASSED [ 34%]
tests/test_filter_builder_complete.py::test_to_qdrant_filter_default_allow PASSED [ 34%]
tests/test_filter_builder_complete.py::test_to_qdrant_filter_multiple_rules PASSED [ 34%]
tests/test_filter_builder_complete.py::test_to_qdrant_filter_match_list_values PASSED [ 34%]
tests/test_filter_builder_complete.py::test_to_qdrant_filter_single_field_condition PASSED [ 34%]
tests/test_filter_builder_complete.py::test_to_qdrant_filter_condition_in_operator PASSED [ 34%]
tests/test_filter_builder_complete.py::test_to_qdrant_filter_invalid_condition_format PASSED [ 34%]
tests/test_filter_builder_complete.py::test_user_satisfies_allow_single_string_role PASSED [ 34%]
tests/test_filter_builder_complete.py::test_get_nested_value_non_dict_intermediate PASSED [ 34%]
tests/test_filter_builder_complete.py::test_to_pgvector_filter_default_allow PASSED [ 34%]
tests/test_filter_builder_complete.py::test_to_pgvector_filter_match_list_values PASSED [ 34%]
tests/test_filter_builder_complete.py::test_to_pgvector_filter_condition_in_operator PASSED [ 34%]
tests/test_filter_builder_complete.py::test_to_pgvector_filter_invalid_condition_format PASSED [ 35%]
tests/test_filter_builder_complete.py::test_to_qdrant_filter_conditions_only PASSED [ 35%]
tests/test_filter_builder_complete.py::test_to_qdrant_filter_no_match_conditions PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestFieldExistenceOperators::test_exists_operator_qdrant PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestFieldExistenceOperators::test_not_exists_operator_qdrant PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestLiteralNoneHandling::test_none_comparison_qdrant PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestLiteralNoneHandling::test_none_in_condition_pgvector PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestUserFieldInRightValue::test_user_field_right_side_qdrant PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestUserFieldInRightValue::test_user_field_right_side_pgvector PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestComplexNestedConditions::test_nested_or_and_qdrant PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestComplexNestedConditions::test_nested_and_or_pgvector PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestBackendSpecificEdgeCases::test_weaviate_filter_generation PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestBackendSpecificEdgeCases::test_pinecone_filter_generation PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestBackendSpecificEdgeCases::test_chromadb_filter_generation PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestBackendSpecificEdgeCases::test_milvus_filter_generation PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestBackendSpecificEdgeCases::test_elasticsearch_filter_generation PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestBackendSpecificEdgeCases::test_azure_search_filter_generation PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestEmptyAndDenyAll::test_deny_all_policy_qdrant PASSED [ 35%]
tests/test_filter_builder_edge_cases.py::TestEmptyAndDenyAll::test_empty_user_context PASSED [ 35%]
tests/test_filter_builder_fallbacks.py::TestChromaDBFilterFallbacks::test_basic_filter_generation PASSED [ 35%]
tests/test_filter_builder_fallbacks.py::TestChromaDBFilterFallbacks::test_user_field_in_document_array PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestChromaDBFilterFallbacks::test_user_field_not_in_document_array PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestChromaDBFilterFallbacks::test_document_field_in_list PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestChromaDBFilterFallbacks::test_document_field_not_in_list PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestChromaDBFilterFallbacks::test_comparison_operators PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestChromaDBFilterFallbacks::test_not_equals_operator PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestChromaDBFilterFallbacks::test_field_exists PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestChromaDBFilterFallbacks::test_field_not_exists PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestChromaDBFilterFallbacks::test_null_user_field_deny PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestChromaDBFilterFallbacks::test_multiple_rules_or PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestChromaDBFilterFallbacks::test_match_with_multiple_fields PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestChromaDBFilterFallbacks::test_literal_in_document_array PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestQdrantFilterFallbacks::test_basic_filter_generation PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestQdrantFilterFallbacks::test_user_id_in_document_array PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestQdrantFilterFallbacks::test_user_id_not_in_document_array PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestQdrantFilterFallbacks::test_document_field_not_in_list PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestQdrantFilterFallbacks::test_comparison_operators PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestQdrantFilterFallbacks::test_field_exists PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestQdrantFilterFallbacks::test_field_not_exists PASSED [ 36%]
tests/test_filter_builder_fallbacks.py::TestQdrantFilterFallbacks::test_null_user_field_creates_empty_filter PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestPineconeFilterFallbacks::test_basic_filter PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestPineconeFilterFallbacks::test_comparison_operators PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestPineconeFilterFallbacks::test_in_operator PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestPineconeFilterFallbacks::test_not_in_operator PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestPgvectorFilterFallbacks::test_basic_filter PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestPgvectorFilterFallbacks::test_comparison_operators PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestPgvectorFilterFallbacks::test_in_operator PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestPgvectorFilterFallbacks::test_user_equals_document PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestWeaviateFilterFallbacks::test_basic_filter PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestWeaviateFilterFallbacks::test_comparison_operators PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestWeaviateFilterFallbacks::test_in_list PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestElasticsearchFilterFallbacks::test_basic_filter PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestElasticsearchFilterFallbacks::test_comparison_operators PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestElasticsearchFilterFallbacks::test_in_list PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestMilvusFilterFallbacks::test_basic_filter PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestMilvusFilterFallbacks::test_comparison_operators PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestMilvusFilterFallbacks::test_in_list PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestAzureSearchFilterFallbacks::test_basic_filter PASSED [ 37%]
tests/test_filter_builder_fallbacks.py::TestAzureSearchFilterFallbacks::test_comparison_operators PASSED [ 38%]
tests/test_filter_builder_fallbacks.py::TestFilterBuilderEdgeCases::test_empty_conditions_allow_all PASSED [ 38%]
tests/test_filter_builder_fallbacks.py::TestFilterBuilderEdgeCases::test_no_matching_roles_deny_all PASSED [ 38%]
tests/test_filter_builder_fallbacks.py::TestFilterBuilderEdgeCases::test_multiple_conditions_and PASSED [ 38%]
tests/test_filter_builder_fallbacks.py::TestFilterBuilderEdgeCases::test_boolean_literal_true PASSED [ 38%]
tests/test_filter_builder_fallbacks.py::TestFilterBuilderEdgeCases::test_boolean_literal_false PASSED [ 38%]
tests/test_filter_builder_fallbacks.py::TestFilterBuilderEdgeCases::test_numeric_literal PASSED [ 38%]
tests/test_filter_cache.py::test_filter_cache_basic_get_set PASSED       [ 38%]
tests/test_filter_cache.py::test_filter_cache_lru_eviction PASSED        [ 38%]
tests/test_filter_cache.py::test_filter_cache_lru_update_on_access PASSED [ 38%]
tests/test_filter_cache.py::test_filter_cache_update_existing PASSED     [ 38%]
tests/test_filter_cache.py::test_filter_cache_invalidate PASSED          [ 38%]
tests/test_filter_cache.py::test_filter_cache_invalidate_all PASSED      [ 38%]
tests/test_filter_cache.py::test_filter_cache_stats PASSED               [ 38%]
tests/test_filter_cache.py::test_filter_cache_reset_stats PASSED         [ 38%]
tests/test_filter_cache.py::test_filter_cache_thread_safety PASSED       [ 38%]
tests/test_filter_cache.py::test_filter_cache_invalid_size PASSED        [ 38%]
tests/test_filter_cache.py::test_cache_key_builder_stable PASSED         [ 38%]
tests/test_filter_cache.py::test_cache_key_builder_different_backends PASSED [ 38%]
tests/test_filter_cache.py::test_cache_key_builder_different_policies PASSED [ 39%]
tests/test_filter_cache.py::test_cache_key_builder_relevant_fields_only PASSED [ 39%]
tests/test_filter_cache.py::test_cache_key_builder_different_relevant_values PASSED [ 39%]
tests/test_filter_cache.py::test_cache_key_builder_list_normalization PASSED [ 39%]
tests/test_filter_cache.py::test_cache_key_builder_nested_fields PASSED  [ 39%]
tests/test_filter_cache.py::test_compute_policy_hash_stable PASSED       [ 39%]
tests/test_filter_cache.py::test_compute_policy_hash_different_policies PASSED [ 39%]
tests/test_filter_cache.py::test_extract_user_fields_roles PASSED        [ 39%]
tests/test_filter_cache.py::test_extract_user_fields_conditions PASSED   [ 39%]
tests/test_filter_cache.py::test_extract_user_fields_nested PASSED       [ 39%]
tests/test_filter_cache.py::test_policy_engine_cache_hit PASSED          [ 39%]
tests/test_filter_cache.py::test_policy_engine_cache_different_users PASSED [ 39%]
tests/test_filter_cache.py::test_policy_engine_cache_disabled PASSED     [ 39%]
tests/test_filter_cache.py::test_policy_engine_invalidate_cache PASSED   [ 39%]
tests/test_filter_cache.py::test_policy_engine_cache_different_backends PASSED [ 39%]
tests/test_filter_cache.py::test_policy_engine_cache_lru_integration PASSED [ 39%]
tests/test_graph_base_and_plugins.py::TestBaseGraphRetriever::test_init_graph_retriever PASSED [ 39%]
tests/test_graph_base_and_plugins.py::TestBaseGraphRetriever::test_execute_search_with_string_query PASSED [ 39%]
tests/test_graph_base_and_plugins.py::TestBaseGraphRetriever::test_execute_search_with_dict_query PASSED [ 39%]
tests/test_graph_base_and_plugins.py::TestBaseGraphRetriever::test_execute_search_with_list_query PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestBaseGraphRetriever::test_execute_search_with_invalid_type PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestBaseGraphRetriever::test_traverse_valid_direction PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestBaseGraphRetriever::test_traverse_invalid_direction PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestAuditSinkBase::test_audit_sink_implementation PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestAuditSinkBase::test_audit_sink_close_default PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestCacheBackendBase::test_cache_backend_implementation PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestCacheBackendBase::test_cache_backend_get_stats_default PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestCacheBackendBase::test_cache_backend_close_default PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestAttributeProviderBase::test_attribute_provider_implementation PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestAttributeProviderBase::test_attribute_provider_enrich_user PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestAttributeProviderBase::test_attribute_provider_enrich_user_no_id PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestAttributeProviderBase::test_attribute_provider_close_default PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestPolicyCoverageTester::test_generate_role_coverage_tests PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestPolicyCoverageTester::test_generate_role_coverage_tests_with_template PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestPolicyCoverageTester::test_generate_field_coverage_tests PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestPolicyCoverageTester::test_generate_field_coverage_tests_with_template PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestPolicyCoverageTester::test_generate_department_coverage_tests PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestPolicyCoverageTester::test_generate_department_coverage_tests_with_sample PASSED [ 40%]
tests/test_graph_base_and_plugins.py::TestPolicyCoverageTester::test_print_results PASSED [ 41%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilder::test_simple_role_match PASSED [ 41%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilder::test_condition_user_equals_document PASSED [ 41%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilder::test_condition_in_list PASSED [ 41%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilder::test_deny_all_no_matching_rules PASSED [ 41%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilder::test_allow_all_default PASSED [ 41%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilder::test_multiple_rules_or PASSED [ 41%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilder::test_comparison_operators PASSED [ 41%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilder::test_not_equals PASSED [ 41%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilder::test_user_in_document_array PASSED [ 41%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilder::test_field_existence PASSED [ 41%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilder::test_simple_role_match PASSED [ 41%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilder::test_condition_user_equals_document PASSED [ 41%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilder::test_deny_all_no_matching_rules PASSED [ 41%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilder::test_within_predicate PASSED [ 41%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilder::test_comparison_operators PASSED [ 41%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilder::test_simple_role_match PASSED [ 41%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilder::test_condition_user_equals_document PASSED [ 41%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilder::test_deny_all_no_matching_rules PASSED [ 41%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilder::test_allow_all_default PASSED [ 42%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilder::test_in_operator PASSED [ 42%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilder::test_boolean_values PASSED [ 42%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilder::test_simple_role_match PASSED [ 42%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilder::test_condition_user_equals_document PASSED [ 42%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilder::test_deny_all_no_matching_rules PASSED [ 42%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilder::test_allow_all_default PASSED [ 42%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilder::test_in_operator PASSED [ 42%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilder::test_not_in_operator PASSED [ 42%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilder::test_field_existence_not_null PASSED [ 42%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilder::test_logical_and_or PASSED [ 42%]
tests/test_graph_filter_builders.py::TestCrossBackendConsistency::test_simple_condition_consistency PASSED [ 42%]
tests/test_graph_filter_builders.py::TestCrossBackendConsistency::test_deny_all_consistency PASSED [ 42%]
tests/test_graph_filter_builders.py::TestCrossBackendConsistency::test_null_user_field_consistency PASSED [ 42%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilderEdgeCases::test_less_than_operator PASSED [ 42%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilderEdgeCases::test_less_than_or_equal_operator PASSED [ 42%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilderEdgeCases::test_greater_than_or_equal_operator PASSED [ 42%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilderEdgeCases::test_not_in_operator_document_field PASSED [ 42%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilderEdgeCases::test_not_in_operator_user_field PASSED [ 42%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilderEdgeCases::test_not_exists_operator PASSED [ 42%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilderEdgeCases::test_custom_node_alias PASSED [ 43%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilderEdgeCases::test_multiple_conditions_and PASSED [ 43%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilderEdgeCases::test_match_with_list_values PASSED [ 43%]
tests/test_graph_filter_builders.py::TestNeo4jFilterBuilderEdgeCases::test_everyone_no_conditions_returns_true PASSED [ 43%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilderEdgeCases::test_less_than_operator PASSED [ 43%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilderEdgeCases::test_less_than_or_equal_operator PASSED [ 43%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilderEdgeCases::test_greater_than_or_equal_operator PASSED [ 43%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilderEdgeCases::test_not_equals_predicate PASSED [ 43%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilderEdgeCases::test_not_in_document_list PASSED [ 43%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilderEdgeCases::test_not_in_document_array PASSED [ 43%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilderEdgeCases::test_not_exists_hasNot PASSED [ 43%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilderEdgeCases::test_exists_predicate PASSED [ 43%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilderEdgeCases::test_allow_all_default_empty_filters PASSED [ 43%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilderEdgeCases::test_everyone_no_conditions_empty_filters PASSED [ 43%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilderEdgeCases::test_user_id_in_document_array_containing PASSED [ 43%]
tests/test_graph_filter_builders.py::TestNeptuneFilterBuilderEdgeCases::test_multiple_rules_or_structure PASSED [ 43%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilderEdgeCases::test_less_than_operator PASSED [ 43%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilderEdgeCases::test_less_than_or_equal_operator PASSED [ 43%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilderEdgeCases::test_greater_than_or_equal_operator PASSED [ 43%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilderEdgeCases::test_not_in_document_list PASSED [ 44%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilderEdgeCases::test_not_in_document_array PASSED [ 44%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilderEdgeCases::test_not_exists_empty_string PASSED [ 44%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilderEdgeCases::test_exists_non_empty_string PASSED [ 44%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilderEdgeCases::test_custom_vertex_alias PASSED [ 44%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilderEdgeCases::test_multiple_conditions_and PASSED [ 44%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilderEdgeCases::test_match_with_list_values PASSED [ 44%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilderEdgeCases::test_everyone_no_conditions_returns_true PASSED [ 44%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilderEdgeCases::test_numeric_match_value PASSED [ 44%]
tests/test_graph_filter_builders.py::TestTigerGraphFilterBuilderEdgeCases::test_boolean_false_value PASSED [ 44%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilderEdgeCases::test_less_than_operator PASSED [ 44%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilderEdgeCases::test_less_than_or_equal_operator PASSED [ 44%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilderEdgeCases::test_greater_than_or_equal_operator PASSED [ 44%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilderEdgeCases::test_not_exists_null_check PASSED [ 44%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilderEdgeCases::test_user_not_in_document_array PASSED [ 44%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilderEdgeCases::test_custom_doc_alias PASSED [ 44%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilderEdgeCases::test_multiple_conditions_and PASSED [ 44%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilderEdgeCases::test_match_with_list_values PASSED [ 44%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilderEdgeCases::test_everyone_no_conditions_returns_true PASSED [ 44%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilderEdgeCases::test_user_in_document_array PASSED [ 45%]
tests/test_graph_filter_builders.py::TestArangoDBFilterBuilderEdgeCases::test_greater_than_operator PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneCompiledConditions::test_compiled_exists_condition PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneCompiledConditions::test_compiled_not_exists_condition PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneCompiledConditions::test_compiled_greater_than PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneCompiledConditions::test_compiled_less_than PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneCompiledConditions::test_compiled_gte_condition PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneCompiledConditions::test_compiled_lte_condition PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneCompiledConditions::test_compiled_not_equals PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneCompiledConditions::test_compiled_not_in_user_field PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneCompiledConditions::test_compiled_not_in_with_null_user PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneCompiledConditions::test_compiled_in_with_null_user PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneCompiledConditions::test_compiled_not_in_document_list PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneCompiledConditions::test_compiled_expression_with_or PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneMultipleRules::test_multiple_rules_or PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneMultipleRules::test_single_matching_rule PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneApplyFilters::test_apply_filters_missing_gremlin PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneApplyFilters::test_apply_eq_filter PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneApplyFilters::test_apply_neq_filter PASSED [ 45%]
tests/test_graph_filter_builders_extended.py::TestNeptuneApplyFilters::test_apply_within_filter PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestNeptuneApplyFilters::test_apply_or_filter PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestNeptuneApplyFilters::test_apply_hasNot_filter PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsing::test_parse_not_equals_string PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsing::test_parse_user_equals_document PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsing::test_parse_document_in_list PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsing::test_parse_document_in_empty_list PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsing::test_parse_not_in_document_list PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsing::test_parse_user_in_document_array PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsing::test_parse_user_not_in_document_array PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCompiledConditions::test_compiled_exists_condition PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCompiledConditions::test_compiled_not_exists_condition PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCompiledConditions::test_compiled_greater_than PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCompiledConditions::test_compiled_less_than PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCompiledConditions::test_compiled_gte_condition PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCompiledConditions::test_compiled_lte_condition PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCompiledConditions::test_compiled_not_equals PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCompiledConditions::test_compiled_not_in_user_field PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCompiledConditions::test_compiled_not_in_with_null_user PASSED [ 46%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCompiledConditions::test_compiled_in_with_null_user PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCompiledConditions::test_compiled_not_in_document_list PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCompiledConditions::test_compiled_expression_with_or PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCompiledConditions::test_compiled_expression_with_and PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphMultipleRules::test_multiple_rules_or PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphMultipleRules::test_single_matching_rule PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsing::test_parse_not_equals_string PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsing::test_parse_user_equals_document PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsing::test_parse_document_in_list PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsing::test_parse_document_in_empty_list PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsing::test_parse_not_in_document_list PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsing::test_parse_user_in_document_array PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsing::test_parse_user_not_in_document_array PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsing::test_parse_exists_from_string PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsing::test_parse_not_exists_from_string PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphFormatValue::test_format_bool_true PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphFormatValue::test_format_bool_false PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphFormatValue::test_format_user_bool PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCustomAlias::test_custom_vertex_alias PASSED [ 47%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCustomAlias::test_match_with_custom_alias PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphMatchConditions::test_match_with_list_value PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphMatchConditions::test_match_with_string_value PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphMatchConditions::test_match_with_number_value PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestNeo4jStringParsingFallback::test_parse_exists_via_string PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestNeo4jStringParsingFallback::test_parse_not_exists_via_string PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestNeo4jStringParsingFallback::test_parse_not_equals_document PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestNeo4jStringParsingFallback::test_parse_user_equals_document PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestNeo4jStringParsingFallback::test_parse_user_equals_document_null_user PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestNeo4jStringParsingFallback::test_parse_document_equals_literal PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestNeo4jStringParsingFallback::test_parse_user_not_in_document PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestNeo4jStringParsingFallback::test_parse_user_not_in_document_null PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestNeo4jStringParsingFallback::test_parse_document_not_in_list PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestNeo4jStringParsingFallback::test_parse_user_in_document PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestNeo4jStringParsingFallback::test_parse_user_in_document_null PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestNeo4jStringParsingFallback::test_parse_document_in_list PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestNeo4jStringParsingFallback::test_parse_document_in_empty_list PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestNeo4jStringParsingFallback::test_parse_invalid_condition PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestNeo4jStringParsingFallback::test_parse_exists_non_document_field PASSED [ 48%]
tests/test_graph_filter_builders_extended.py::TestArangoDBStringParsingFallback::test_parse_exists_via_string PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestArangoDBStringParsingFallback::test_parse_not_exists_via_string PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestArangoDBStringParsingFallback::test_parse_not_equals_document PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestArangoDBStringParsingFallback::test_parse_user_equals_document PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestArangoDBStringParsingFallback::test_parse_user_equals_document_null PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestArangoDBStringParsingFallback::test_parse_document_equals_literal PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestArangoDBStringParsingFallback::test_parse_user_not_in_document PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestArangoDBStringParsingFallback::test_parse_user_not_in_document_null PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestArangoDBStringParsingFallback::test_parse_document_not_in_list PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestArangoDBStringParsingFallback::test_parse_user_in_document PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestArangoDBStringParsingFallback::test_parse_user_in_document_null PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestArangoDBStringParsingFallback::test_parse_document_in_list PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestArangoDBStringParsingFallback::test_parse_document_in_empty_list PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsingFallback::test_parse_exists_via_string PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsingFallback::test_parse_not_exists_via_string PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsingFallback::test_parse_not_equals_document PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsingFallback::test_parse_user_equals_document PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsingFallback::test_parse_user_equals_document_null PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsingFallback::test_parse_document_equals_literal PASSED [ 49%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsingFallback::test_parse_user_not_in_document PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsingFallback::test_parse_user_not_in_document_null PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsingFallback::test_parse_document_not_in_list PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsingFallback::test_parse_user_in_document PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsingFallback::test_parse_user_in_document_null PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsingFallback::test_parse_document_in_list PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsingFallback::test_parse_document_in_empty_list PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestNeptuneStringParsingFallback::test_parse_invalid_condition_returns_none PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsingFallback::test_parse_exists_via_string PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsingFallback::test_parse_not_exists_via_string PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsingFallback::test_parse_not_equals_document PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsingFallback::test_parse_user_equals_document PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsingFallback::test_parse_user_equals_document_null PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsingFallback::test_parse_document_equals_literal PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsingFallback::test_parse_user_not_in_document PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsingFallback::test_parse_user_not_in_document_null PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsingFallback::test_parse_document_not_in_list PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsingFallback::test_parse_user_in_document PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsingFallback::test_parse_user_in_document_null PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsingFallback::test_parse_document_in_list PASSED [ 50%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphStringParsingFallback::test_parse_document_in_empty_list PASSED [ 51%]
tests/test_graph_filter_builders_extended.py::TestNeo4jCompiledExpressionPaths::test_compiled_expression_or_multiple_children PASSED [ 51%]
tests/test_graph_filter_builders_extended.py::TestNeo4jCompiledExpressionPaths::test_compiled_expression_and_multiple_children PASSED [ 51%]
tests/test_graph_filter_builders_extended.py::TestNeo4jCompiledExpressionPaths::test_compiled_expression_single_child PASSED [ 51%]
tests/test_graph_filter_builders_extended.py::TestNeo4jCompiledExpressionPaths::test_compiled_expression_empty_children PASSED [ 51%]
tests/test_graph_filter_builders_extended.py::TestArangoDBCompiledExpressionPaths::test_compiled_expression_or_multiple_children PASSED [ 51%]
tests/test_graph_filter_builders_extended.py::TestArangoDBCompiledExpressionPaths::test_compiled_expression_and_multiple_children PASSED [ 51%]
tests/test_graph_filter_builders_extended.py::TestNeptuneCompiledExpressionPaths::test_compiled_expression_or_multiple_children PASSED [ 51%]
tests/test_graph_filter_builders_extended.py::TestNeptuneCompiledExpressionPaths::test_compiled_expression_and_multiple_children PASSED [ 51%]
tests/test_graph_filter_builders_extended.py::TestNeptuneCompiledExpressionPaths::test_compiled_expression_single_child PASSED [ 51%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCompiledExpressionPaths::test_compiled_expression_or_multiple_children PASSED [ 51%]
tests/test_graph_filter_builders_extended.py::TestTigerGraphCompiledExpressionPaths::test_compiled_expression_and_multiple_children PASSED [ 51%]
tests/test_graph_retrievers.py::TestBaseGraphRetriever::test_base_graph_retriever_is_abstract PASSED [ 51%]
tests/test_graph_retrievers.py::TestNeo4jSecureRetriever::test_initialization PASSED [ 51%]
tests/test_graph_retrievers.py::TestNeo4jSecureRetriever::test_backend_name PASSED [ 51%]
tests/test_graph_retrievers.py::TestNeo4jSecureRetriever::test_property_search PASSED [ 51%]
tests/test_graph_retrievers.py::TestNeo4jSecureRetriever::test_traversal PASSED [ 51%]
tests/test_graph_retrievers.py::TestNeptuneSecureRetriever::test_backend_name PASSED [ 51%]
tests/test_graph_retrievers.py::TestNeptuneSecureRetriever::test_matches_single_filter PASSED [ 51%]
tests/test_graph_retrievers.py::TestNeptuneSecureRetriever::test_matches_filters PASSED [ 52%]
tests/test_graph_retrievers.py::TestTigerGraphSecureRetriever::test_backend_name PASSED [ 52%]
tests/test_graph_retrievers.py::TestTigerGraphSecureRetriever::test_matches_properties PASSED [ 52%]
tests/test_graph_retrievers.py::TestArangoDBSecureRetriever::test_backend_name PASSED [ 52%]
tests/test_graph_retrievers.py::TestArangoDBSecureRetriever::test_execute_property_search PASSED [ 52%]
tests/test_graph_retrievers.py::TestArangoDBSecureRetriever::test_health_check PASSED [ 52%]
tests/test_graph_retrievers.py::TestGraphRetrieverFeatures::test_traverse_validates_direction PASSED [ 52%]
tests/test_graph_retrievers.py::TestGraphRetrieverFeatures::test_vector_search_not_implemented_by_default PASSED [ 52%]
tests/test_graph_retrievers.py::TestGraphRetrieverPolicyIntegration::test_neo4j_uses_policy_engine PASSED [ 52%]
tests/test_graph_retrievers.py::TestGraphRetrieverErrorHandling::test_neo4j_query_execution_error PASSED [ 52%]
tests/test_graph_retrievers.py::TestGraphRetrieverErrorHandling::test_arangodb_query_execution_error PASSED [ 52%]
tests/test_graph_retrievers.py::TestGraphRetrieverErrorHandling::test_neptune_filter_matching_edge_cases PASSED [ 52%]
tests/test_graph_retrievers.py::TestGraphRetrieverErrorHandling::test_tigergraph_matches_properties_nested PASSED [ 52%]
tests/test_graph_retrievers.py::TestGraphRetrieverErrorHandling::test_traverse_direction_validation_all_backends PASSED [ 52%]
tests/test_graph_retrievers.py::TestNeptuneFilterMatching::test_or_filter_matching PASSED [ 52%]
tests/test_graph_retrievers.py::TestNeptuneFilterMatching::test_containing_predicate PASSED [ 52%]
tests/test_graph_retrievers.py::TestNeptuneFilterMatching::test_unknown_predicate_fallback PASSED [ 52%]
tests/test_graph_retrievers.py::TestArangoDBRetrieverEdgeCases::test_execute_graph_query PASSED [ 52%]
tests/test_graph_retrievers.py::TestArangoDBRetrieverEdgeCases::test_execute_traversal PASSED [ 52%]
tests/test_graph_retrievers_extended.py::TestTigerGraphExecuteGraphQuery::test_run_query_without_permission_filter PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphExecuteGraphQuery::test_run_query_with_permission_filter_and_post_filter PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphExecuteGraphQuery::test_select_query_with_where_clause PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphExecuteGraphQuery::test_select_query_with_order_clause PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphExecuteGraphQuery::test_select_query_with_limit_clause PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphExecuteGraphQuery::test_query_without_select PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphExecuteGraphQuery::test_query_without_permission_filter PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphPropertySearch::test_property_search_with_string_value PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphPropertySearch::test_property_search_with_bool_value PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphPropertySearch::test_property_search_with_int_value PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphPropertySearch::test_property_search_with_list_value PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphPropertySearch::test_property_search_rest_api_fallback PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphPropertySearch::test_property_search_filter_mismatch PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphMatchesProperties::test_matches_with_attributes_wrapper PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphMatchesProperties::test_matches_without_attributes_wrapper PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphMatchesProperties::test_matches_with_list_value PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphMatchesPermissionFilter::test_matches_empty_filter PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphMatchesPermissionFilter::test_matches_false_filter PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphMatchesPermissionFilter::test_matches_complex_filter_default PASSED [ 53%]
tests/test_graph_retrievers_extended.py::TestTigerGraphPostFilterResults::test_post_filter_results PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestTigerGraphTraversal::test_traversal_outgoing PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestTigerGraphTraversal::test_traversal_incoming PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestTigerGraphTraversal::test_traversal_both_directions PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestTigerGraphTraversal::test_traversal_multi_depth PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestTigerGraphTraversal::test_traversal_with_permission_filter PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestTigerGraphHealthCheck::test_health_check_with_statistics PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestTigerGraphHealthCheck::test_health_check_fallback_to_echo PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestNeptuneExecuteGraphQuery::test_execute_query_with_post_filter PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestNeptuneExecuteGraphQuery::test_execute_query_without_filter PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestNeptuneExecuteGraphQuery::test_execute_query_with_limit PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestNeptunePropertySearch::test_property_search_with_string PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestNeptunePropertySearch::test_property_search_with_int PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestNeptunePropertySearch::test_property_search_with_bool PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestNeptunePropertySearch::test_property_search_with_list PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestNeptunePropertySearch::test_property_search_with_permission_filters PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestNeptuneFilterToGremlinString::test_has_not_filter PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestNeptuneFilterToGremlinString::test_eq_filter_string PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestNeptuneFilterToGremlinString::test_eq_filter_int PASSED [ 54%]
tests/test_graph_retrievers_extended.py::TestNeptuneFilterToGremlinString::test_neq_filter PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeptuneFilterToGremlinString::test_within_filter PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeptuneFilterToGremlinString::test_without_filter PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeptuneFilterToGremlinString::test_comparison_filters PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeptuneFilterToGremlinString::test_exists_filter PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeptuneFilterToGremlinString::test_or_filter PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeptuneFilterToGremlinString::test_unknown_type_returns_empty PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeptuneTraversal::test_traversal_outgoing PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeptuneTraversal::test_traversal_incoming PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeptuneTraversal::test_traversal_both_directions PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeptuneTraversal::test_traversal_multi_depth PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeptuneHealthCheckAndExit::test_health_check PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeptuneHealthCheckAndExit::test_exit_closes_client PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeptuneHealthCheckAndExit::test_exit_handles_close_error PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeo4jGraphQuery::test_query_with_existing_where_clause PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeo4jGraphQuery::test_query_with_return_but_no_where PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeo4jGraphQuery::test_query_without_where_or_return PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeo4jGraphQuery::test_query_with_empty_permission_filter PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeo4jGraphQuery::test_query_with_existing_limit PASSED [ 55%]
tests/test_graph_retrievers_extended.py::TestNeo4jVectorSearch::test_vector_search_with_permission_filter PASSED [ 56%]
tests/test_graph_retrievers_extended.py::TestNeo4jVectorSearch::test_vector_search_without_permission_filter PASSED [ 56%]
tests/test_graph_retrievers_extended.py::TestNeo4jTraversal::test_traversal_incoming PASSED [ 56%]
tests/test_graph_retrievers_extended.py::TestNeo4jTraversal::test_traversal_both_directions PASSED [ 56%]
tests/test_graph_retrievers_extended.py::TestNeo4jHealthCheckAndExit::test_health_check PASSED [ 56%]
tests/test_graph_retrievers_extended.py::TestNeo4jHealthCheckAndExit::test_get_session_with_database PASSED [ 56%]
tests/test_graph_retrievers_extended.py::TestNeo4jHealthCheckAndExit::test_get_session_without_database PASSED [ 56%]
tests/test_graph_retrievers_extended.py::TestNeo4jHealthCheckAndExit::test_exit_closes_driver PASSED [ 56%]
tests/test_graph_retrievers_extended.py::TestNeo4jHealthCheckAndExit::test_exit_handles_close_error PASSED [ 56%]
tests/test_graph_retrievers_extended.py::TestNeptuneMatchesSingleFilter::test_missing_property_with_exists_false PASSED [ 56%]
tests/test_graph_retrievers_extended.py::TestNeptuneMatchesSingleFilter::test_not_containing_predicate PASSED [ 56%]
tests/test_graph_retrievers_extended.py::TestNeptuneMatchesSingleFilter::test_not_containing_non_list PASSED [ 56%]
tests/test_graph_retrievers_extended.py::TestNeptuneMatchesSingleFilter::test_containing_non_list PASSED [ 56%]
tests/test_health_coverage.py::TestHealthCheckManager::test_health_endpoint_healthy PASSED [ 56%]
tests/test_health_coverage.py::TestHealthCheckManager::test_health_endpoint_retriever_none PASSED [ 56%]
tests/test_health_coverage.py::TestHealthCheckManager::test_health_endpoint_retriever_error PASSED [ 56%]
tests/test_health_coverage.py::TestHealthCheckManager::test_readiness_endpoint_ready PASSED [ 56%]
tests/test_health_coverage.py::TestHealthCheckManager::test_readiness_endpoint_not_ready PASSED [ 56%]
tests/test_health_coverage.py::TestHealthCheckManager::test_readiness_endpoint_with_custom_checks_pass PASSED [ 56%]
tests/test_health_coverage.py::TestHealthCheckManager::test_readiness_endpoint_with_custom_checks_fail PASSED [ 57%]
tests/test_health_coverage.py::TestHealthCheckManager::test_readiness_endpoint_custom_check_error PASSED [ 57%]
tests/test_health_coverage.py::TestHealthCheckManager::test_readiness_endpoint_retriever_error PASSED [ 57%]
tests/test_health_coverage.py::TestHealthCheckManager::test_startup_endpoint_success PASSED [ 57%]
tests/test_health_coverage.py::TestHealthCheckManager::test_startup_endpoint_still_starting PASSED [ 57%]
tests/test_health_coverage.py::TestHealthCheckManager::test_startup_endpoint_timeout PASSED [ 57%]
tests/test_health_coverage.py::TestHealthCheckManager::test_startup_endpoint_error PASSED [ 57%]
tests/test_health_coverage.py::TestFlaskHealthEndpoints::test_flask_endpoints_registered PASSED [ 57%]
tests/test_health_coverage.py::TestFlaskHealthEndpoints::test_flask_endpoints_with_prefix PASSED [ 57%]
tests/test_health_coverage.py::TestFastAPIHealthEndpoints::test_fastapi_endpoints_registered PASSED [ 57%]
tests/test_health_coverage.py::TestFastAPIHealthEndpoints::test_fastapi_endpoints_with_prefix PASSED [ 57%]
tests/test_health_coverage.py::TestHealthCheckEdgeCases::test_multiple_custom_checks PASSED [ 57%]
tests/test_health_coverage.py::TestHealthCheckEdgeCases::test_custom_check_short_circuits_on_failure PASSED [ 57%]
tests/test_health_coverage.py::TestHealthCheckEdgeCases::test_health_details_propagated PASSED [ 57%]
tests/test_health_endpoints.py::test_health_endpoint_healthy PASSED      [ 57%]
tests/test_health_endpoints.py::test_health_endpoint_none_retriever PASSED [ 57%]
tests/test_health_endpoints.py::test_health_endpoint_exception PASSED    [ 57%]
tests/test_health_endpoints.py::test_readiness_endpoint_ready PASSED     [ 57%]
tests/test_health_endpoints.py::test_readiness_endpoint_not_ready PASSED [ 57%]
tests/test_health_endpoints.py::test_readiness_endpoint_custom_check_passes PASSED [ 57%]
tests/test_health_endpoints.py::test_readiness_endpoint_custom_check_fails PASSED [ 58%]
tests/test_health_endpoints.py::test_readiness_endpoint_custom_check_exception PASSED [ 58%]
tests/test_health_endpoints.py::test_startup_endpoint_success PASSED     [ 58%]
tests/test_health_endpoints.py::test_startup_endpoint_timeout PASSED     [ 58%]
tests/test_health_endpoints.py::test_startup_endpoint_still_starting PASSED [ 58%]
tests/test_health_endpoints.py::test_startup_endpoint_exception PASSED   [ 58%]
tests/test_health_endpoints.py::test_flask_endpoints_registration PASSED [ 58%]
tests/test_health_endpoints.py::test_flask_endpoints_with_prefix PASSED  [ 58%]
tests/test_health_endpoints.py::test_fastapi_endpoints_registration PASSED [ 58%]
tests/test_health_endpoints.py::test_fastapi_endpoints_with_prefix PASSED [ 58%]
tests/test_integrations_extended.py::TestSecureLlamaIndexRetriever::test_missing_llamaindex_import PASSED [ 58%]
tests/test_integrations_extended.py::TestSecureLlamaIndexRetriever::test_invalid_retriever_type PASSED [ 58%]
tests/test_integrations_extended.py::TestSecureLlamaIndexRetriever::test_retrieve_with_permissions PASSED [ 58%]
tests/test_integrations_extended.py::TestSecureLlamaIndexRetriever::test_retrieve_without_user_context PASSED [ 58%]
tests/test_integrations_extended.py::TestSecureLlamaIndexRetriever::test_internal_retrieve_method PASSED [ 58%]
tests/test_integrations_extended.py::TestSecureQueryEngine::test_missing_llamaindex_import PASSED [ 58%]
tests/test_integrations_extended.py::TestSecureQueryEngine::test_invalid_index_type PASSED [ 58%]
tests/test_integrations_extended.py::TestSecureQueryEngine::test_query_method PASSED [ 58%]
tests/test_integrations_extended.py::TestWrapRetrieverFunction::test_wrap_retriever PASSED [ 58%]
tests/test_integrations_extended.py::TestLangGraphIntegration::test_secure_retriever_node_missing_langgraph PASSED [ 59%]
tests/test_integrations_extended.py::TestLangGraphIntegration::test_create_secure_retriever_node_with_retriever PASSED [ 59%]
tests/test_integrations_extended.py::TestLangGraphIntegration::test_secure_retriever_node_execution PASSED [ 59%]
tests/test_integrations_extended.py::TestLangGraphIntegration::test_secure_retriever_node_missing_query PASSED [ 59%]
tests/test_integrations_extended.py::TestLangGraphIntegration::test_secure_retriever_node_missing_user PASSED [ 59%]
tests/test_integrations_extended.py::TestLangGraphIntegration::test_secure_retriever_tool PASSED [ 59%]
tests/test_integrations_extended.py::TestAWSBedrockIntegration::test_bedrock_retriever_class_exists PASSED [ 59%]
tests/test_integrations_extended.py::TestIntegrationsInit::test_import_llamaindex_when_available PASSED [ 59%]
tests/test_integrations_extended.py::TestIntegrationsInit::test_import_langgraph_when_available PASSED [ 59%]
tests/test_langchain.py::test_langchain_retriever_initialization PASSED  [ 59%]
tests/test_langchain.py::test_langchain_retriever_set_user PASSED        [ 59%]
tests/test_langchain.py::test_langchain_retriever_no_user_raises_error PASSED [ 59%]
tests/test_langchain.py::test_langchain_retriever_with_audit_logger PASSED [ 59%]
tests/test_langchain.py::test_langchain_pgvector_retriever_initialization PASSED [ 59%]
tests/test_langchain.py::test_langchain_pgvector_retriever_set_user PASSED [ 59%]
tests/test_langchain.py::test_langchain_pgvector_retriever_no_user_raises_error PASSED [ 59%]
tests/test_langchain_generic_wrapper.py::TestLangChainRetrieverWrapper::test_wrapper_initialization PASSED [ 59%]
tests/test_langchain_generic_wrapper.py::TestLangChainRetrieverWrapper::test_wrapper_custom_text_key PASSED [ 59%]
tests/test_langchain_generic_wrapper.py::TestLangChainRetrieverWrapper::test_wrapper_custom_content_keys PASSED [ 59%]
tests/test_langchain_generic_wrapper.py::TestLangChainRetrieverWrapper::test_set_user PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestLangChainRetrieverWrapper::test_get_relevant_documents_with_user_kwarg PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestLangChainRetrieverWrapper::test_get_relevant_documents_with_set_user PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestLangChainRetrieverWrapper::test_get_relevant_documents_missing_user PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestLangChainRetrieverWrapper::test_extract_text_from_dict_result PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestLangChainRetrieverWrapper::test_extract_text_fallback_keys PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestLangChainRetrieverWrapper::test_extract_text_from_qdrant_result PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestLangChainRetrieverWrapper::test_extract_text_from_object_with_metadata PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestLangChainRetrieverWrapper::test_wrap_retriever_function PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestLangChainRetrieverWrapper::test_limit_parameter_k PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestLangChainRetrieverWrapper::test_limit_parameter_explicit PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestChromaDBLangChainIntegration::test_chromadb_wrapper_with_permissions PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestChromaDBLangChainIntegration::test_chromadb_real_retriever_mock PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestPineconeLangChainIntegration::test_pinecone_wrapper_with_permissions PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestPineconeLangChainIntegration::test_pinecone_with_namespace_and_permissions PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestWeaviateLangChainIntegration::test_weaviate_wrapper_with_permissions PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestWeaviateLangChainIntegration::test_weaviate_tenant_isolation PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestMilvusLangChainIntegration::test_milvus_wrapper_with_permissions PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestMilvusLangChainIntegration::test_milvus_partition_permissions PASSED [ 60%]
tests/test_langchain_generic_wrapper.py::TestElasticsearchLangChainIntegration::test_elasticsearch_wrapper_with_permissions PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestElasticsearchLangChainIntegration::test_elasticsearch_index_permissions PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestPermissionFilteringIntegration::test_role_based_access PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestPermissionFilteringIntegration::test_attribute_based_access PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestPermissionFilteringIntegration::test_owner_based_access PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestEdgeCases::test_empty_results PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestEdgeCases::test_missing_text_field PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestEdgeCases::test_none_metadata_values PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestEdgeCases::test_special_characters_in_query PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestEdgeCases::test_unicode_content PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestEdgeCases::test_large_metadata PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestLangChainSecureRetriever::test_initialization PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestLangChainSecureRetriever::test_set_user PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestLangChainSecureRetriever::test_get_relevant_documents_with_user PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestLangChainSecureRetriever::test_get_relevant_documents_missing_user PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestLangChainSecureRetriever::test_handle_qdrant_scored_point PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestLangChainSecureRetriever::test_handle_query_response_format PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestLangChainSecureRetriever::test_handle_fallback_format PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestLangChainSecureRetriever::test_content_field_extraction PASSED [ 61%]
tests/test_langchain_generic_wrapper.py::TestLangChainSecureRetriever::test_k_parameter_for_limit PASSED [ 62%]
tests/test_langchain_generic_wrapper.py::TestLangChainSecureRetriever::test_with_audit_logger PASSED [ 62%]
tests/test_langchain_generic_wrapper.py::TestLangChainAdditionalEdgeCases::test_langchain_unavailable_error PASSED [ 62%]
tests/test_langchain_generic_wrapper.py::TestLangChainAdditionalEdgeCases::test_wrapper_result_conversion_error PASSED [ 62%]
tests/test_langchain_generic_wrapper.py::TestLangChainAdditionalEdgeCases::test_wrapper_raw_result_fallback PASSED [ 62%]
tests/test_langchain_retrieval.py::test_langchain_retriever_actual_retrieval PASSED [ 62%]
tests/test_langchain_retrieval.py::test_langchain_retriever_with_content_field PASSED [ 62%]
tests/test_langchain_retrieval.py::test_langchain_retriever_with_k_parameter PASSED [ 62%]
tests/test_langchain_retrieval.py::test_langchain_retriever_with_search_kwargs PASSED [ 62%]
tests/test_langchain_retrieval.py::test_langchain_pgvector_retriever_actual_retrieval PASSED [ 62%]
tests/test_langchain_retrieval.py::test_langchain_pgvector_retriever_with_k_parameter PASSED [ 62%]
tests/test_langchain_retrieval.py::test_langchain_pgvector_retriever_content_field PASSED [ 62%]
tests/test_langchain_retrieval.py::test_langchain_pgvector_retriever_custom_text_column PASSED [ 62%]
tests/test_list_quote_parsing.py::test_list_with_normal_strings PASSED   [ 62%]
tests/test_list_quote_parsing.py::test_list_with_double_quoted_strings PASSED [ 62%]
tests/test_list_quote_parsing.py::test_list_with_mixed_quotes PASSED     [ 62%]
tests/test_list_quote_parsing.py::test_list_with_escaped_quotes PASSED   [ 62%]
tests/test_list_quote_parsing.py::test_list_with_escaped_quotes_in_double_quotes PASSED [ 62%]
tests/test_list_quote_parsing.py::test_list_unclosed_single_quote PASSED [ 62%]
tests/test_list_quote_parsing.py::test_list_unclosed_double_quote PASSED [ 63%]
tests/test_list_quote_parsing.py::test_list_extra_opening_quote PASSED   [ 63%]
tests/test_list_quote_parsing.py::test_list_with_empty_string PASSED     [ 63%]
tests/test_list_quote_parsing.py::test_list_with_comma_in_string PASSED  [ 63%]
tests/test_list_quote_parsing.py::test_list_with_nested_brackets PASSED  [ 63%]
tests/test_list_quote_parsing.py::test_list_with_backslash_escape PASSED [ 63%]
tests/test_list_quote_parsing.py::test_list_with_unicode PASSED          [ 63%]
tests/test_list_quote_parsing.py::test_list_with_numbers PASSED          [ 63%]
tests/test_list_quote_parsing.py::test_list_with_mixed_types PASSED      [ 63%]
tests/test_list_quote_parsing.py::test_list_with_whitespace PASSED       [ 63%]
tests/test_list_quote_parsing.py::test_empty_list PASSED                 [ 63%]
tests/test_list_quote_parsing.py::test_list_single_item PASSED           [ 63%]
tests/test_list_quote_parsing.py::test_list_with_special_characters PASSED [ 63%]
tests/test_list_quote_parsing.py::test_list_in_complex_expression PASSED [ 63%]
tests/test_list_quote_parsing.py::test_list_mismatched_brackets PASSED   [ 63%]
tests/test_list_quote_parsing.py::test_quote_state_tracking PASSED       [ 63%]
tests/test_logging.py::test_get_logger PASSED                            [ 63%]
tests/test_logging.py::test_structured_formatter PASSED                  [ 63%]
tests/test_logging.py::test_log_context PASSED                           [ 63%]
tests/test_logging.py::test_nested_log_context PASSED                    [ 64%]
tests/test_logging.py::test_configure_logging PASSED                     [ 64%]
tests/test_logging.py::test_set_log_level PASSED                         [ 64%]
tests/test_logging.py::test_logging_with_extra_fields PASSED             [ 64%]
tests/test_logging.py::test_error_logging_includes_traceback PASSED      [ 64%]
tests/test_logging.py::test_clear_log_context PASSED                     [ 64%]
tests/test_logging.py::test_timestamp_formats PASSED                     [ 64%]
tests/test_mcp_integration.py::TestRAGGuardMCPServer::test_mcp_not_available_error PASSED [ 64%]
tests/test_mcp_integration.py::TestRAGGuardMCPServer::test_server_initialization PASSED [ 64%]
tests/test_mcp_integration.py::TestRAGGuardMCPServer::test_create_mcp_server_function PASSED [ 64%]
tests/test_mcp_integration.py::TestMCPToolHandlers::test_secure_search_handler PASSED [ 64%]
tests/test_mcp_integration.py::TestMCPToolHandlers::test_secure_search_missing_user_id PASSED [ 64%]
tests/test_mcp_integration.py::TestMCPToolHandlers::test_check_access_handler PASSED [ 64%]
tests/test_mcp_integration.py::TestMCPToolHandlers::test_check_access_fallback PASSED [ 64%]
tests/test_mcp_integration.py::TestMCPResultFormatting::test_format_dict_results PASSED [ 64%]
tests/test_mcp_integration.py::TestMCPResultFormatting::test_format_qdrant_results PASSED [ 64%]
tests/test_mcp_integration.py::TestMCPResultFormatting::test_format_results_custom_text_key PASSED [ 64%]
tests/test_mcp_integration.py::TestMCPPermissionFiltering::test_role_based_filtering PASSED [ 64%]
tests/test_mcp_integration.py::TestMCPPermissionFiltering::test_attribute_based_filtering PASSED [ 64%]
tests/test_mcp_integration.py::TestMCPErrorHandling::test_search_error_handling PASSED [ 64%]
tests/test_mcp_integration.py::TestMCPErrorHandling::test_check_access_error_handling PASSED [ 65%]
tests/test_mcp_integration.py::TestMCPErrorHandling::test_missing_required_params PASSED [ 65%]
tests/test_mcp_integration.py::TestMCPRetrieverTool::test_decorator_wraps_retriever PASSED [ 65%]
tests/test_milvus_advanced.py::test_milvus_health_check_success PASSED   [ 65%]
tests/test_milvus_advanced.py::test_milvus_context_manager PASSED        [ 65%]
tests/test_milvus_advanced.py::test_milvus_with_validation PASSED        [ 65%]
tests/test_milvus_advanced.py::test_milvus_with_retry PASSED             [ 65%]
tests/test_milvus_advanced.py::test_milvus_with_cache PASSED             [ 65%]
tests/test_milvus_advanced.py::test_milvus_with_audit_logging PASSED     [ 65%]
tests/test_milvus_advanced.py::test_milvus_search_failure PASSED         [ 65%]
tests/test_milvus_advanced.py::test_milvus_empty_results PASSED          [ 65%]
tests/test_milvus_advanced.py::test_milvus_batch_search PASSED           [ 65%]
tests/test_milvus_advanced.py::test_milvus_policy_update PASSED          [ 65%]
tests/test_milvus_coverage.py::TestMilvusSecureRetrieverInit::test_import_error_when_pymilvus_missing PASSED [ 65%]
tests/test_milvus_coverage.py::TestMilvusSecureRetrieverInit::test_init_with_milvus_client_api PASSED [ 65%]
tests/test_milvus_coverage.py::TestMilvusSecureRetrieverInit::test_init_custom_output_fields PASSED [ 65%]
tests/test_milvus_coverage.py::TestMilvusVerifyCollection::test_verify_collection_not_found PASSED [ 65%]
tests/test_milvus_coverage.py::TestMilvusVerifyCollection::test_verify_collection_exception PASSED [ 65%]
tests/test_milvus_coverage.py::TestMilvusExecuteSearch::test_execute_search_milvus_client_api PASSED [ 65%]
tests/test_milvus_coverage.py::TestMilvusExecuteSearch::test_execute_search_empty_results PASSED [ 66%]
tests/test_milvus_coverage.py::TestMilvusExecuteSearch::test_execute_search_connection_error PASSED [ 66%]
tests/test_milvus_coverage.py::TestMilvusExecuteSearch::test_execute_search_generic_error PASSED [ 66%]
tests/test_milvus_coverage.py::TestMilvusPostFilterResults::test_post_filter_dict_format PASSED [ 66%]
tests/test_milvus_coverage.py::TestMilvusPostFilterResults::test_post_filter_legacy_entity_format PASSED [ 66%]
tests/test_milvus_coverage.py::TestMilvusPostFilterResults::test_post_filter_fallback_format PASSED [ 66%]
tests/test_milvus_coverage.py::TestMilvusCheckBackendHealth::test_health_check_milvus_client_api PASSED [ 66%]
tests/test_milvus_coverage.py::TestMilvusCheckBackendHealth::test_health_check_collection_not_found PASSED [ 66%]
tests/test_milvus_coverage.py::TestMilvusCheckBackendHealth::test_health_check_stats_error PASSED [ 66%]
tests/test_milvus_coverage.py::TestMilvusCheckBackendHealth::test_health_check_connection_error PASSED [ 66%]
tests/test_milvus_coverage.py::TestMilvusSearch::test_search_with_metric_type PASSED [ 66%]
tests/test_milvus_coverage.py::TestMilvusSearch::test_search_with_search_params PASSED [ 66%]
tests/test_milvus_coverage.py::TestZillizSecureRetriever::test_zilliz_is_alias PASSED [ 66%]
tests/test_milvus_coverage.py::TestZillizSecureRetriever::test_zilliz_instantiation PASSED [ 66%]
tests/test_milvus_retriever.py::test_milvus_retriever_import PASSED      [ 66%]
tests/test_milvus_retriever.py::test_milvus_retriever_initialization PASSED [ 66%]
tests/test_milvus_retriever.py::test_milvus_search_with_policy PASSED    [ 66%]
tests/test_milvus_retriever.py::test_milvus_search_different_department PASSED [ 66%]
tests/test_milvus_retriever.py::test_milvus_filter_generation PASSED     [ 66%]
tests/test_milvus_retriever.py::test_milvus_result_standardization PASSED [ 67%]
tests/test_milvus_retriever.py::test_zilliz_retriever_alias PASSED       [ 67%]
tests/test_milvus_retriever.py::test_milvus_custom_vector_field PASSED   [ 67%]
tests/test_milvus_retriever.py::test_milvus_custom_output_fields PASSED  [ 67%]
tests/test_milvus_retriever.py::test_milvus_missing_pymilvus PASSED      [ 67%]
tests/test_milvus_retriever.py::test_milvus_filter_builder PASSED        [ 67%]
tests/test_milvus_retriever.py::test_milvus_filter_or_logic PASSED       [ 67%]
tests/test_none_field_security_bug.py::test_not_equals_with_missing_field_should_deny PASSED [ 67%]
tests/test_none_field_security_bug.py::test_not_equals_document_field_missing_should_deny PASSED [ 67%]
tests/test_none_field_security_bug.py::test_compiled_not_equals_with_missing_field PASSED [ 67%]
tests/test_none_field_security_bug.py::test_comparison_operators_deny_on_none PASSED [ 67%]
tests/test_none_field_security_bug.py::test_proper_not_equals_usage_with_field_check PASSED [ 67%]
tests/test_or_complexity_limits.py::test_expression_depth_limit PASSED   [ 67%]
tests/test_or_complexity_limits.py::test_or_branch_count_limit PASSED    [ 67%]
tests/test_or_complexity_limits.py::test_and_branch_count_limit PASSED   [ 67%]
tests/test_or_complexity_limits.py::test_total_conditions_limit PASSED   [ 67%]
tests/test_or_complexity_limits.py::test_within_depth_limit PASSED       [ 67%]
tests/test_or_complexity_limits.py::test_within_branch_limit PASSED      [ 67%]
tests/test_or_complexity_limits.py::test_within_conditions_limit PASSED  [ 67%]
tests/test_or_complexity_limits.py::test_complexity_error_messages PASSED [ 68%]
tests/test_or_complexity_limits.py::test_count_conditions_simple PASSED  [ 68%]
tests/test_or_complexity_limits.py::test_count_conditions_nested PASSED  [ 68%]
tests/test_or_complexity_limits.py::test_count_conditions_deep PASSED    [ 68%]
tests/test_or_complexity_limits.py::test_get_depth_simple PASSED         [ 68%]
tests/test_or_complexity_limits.py::test_get_depth_nested PASSED         [ 68%]
tests/test_or_complexity_limits.py::test_get_depth_deeply_nested PASSED  [ 68%]
tests/test_or_complexity_limits.py::test_policy_with_complex_expression PASSED [ 68%]
tests/test_or_logic.py::test_simple_or_expression PASSED                 [ 68%]
tests/test_or_logic.py::test_simple_and_expression PASSED                [ 68%]
tests/test_or_logic.py::test_or_with_three_conditions PASSED             [ 68%]
tests/test_or_logic.py::test_nested_or_and PASSED                        [ 68%]
tests/test_or_logic.py::test_deeply_nested_expression PASSED             [ 68%]
tests/test_or_logic.py::test_backward_compatibility_simple_condition PASSED [ 68%]
tests/test_or_logic.py::test_parentheses_unwrapping PASSED               [ 68%]
tests/test_or_logic.py::test_or_precedence PASSED                        [ 68%]
tests/test_or_logic.py::test_case_insensitive_operators PASSED           [ 68%]
tests/test_or_logic.py::test_unbalanced_parentheses_open PASSED          [ 68%]
tests/test_or_logic.py::test_unbalanced_parentheses_close PASSED         [ 68%]
tests/test_or_logic.py::test_or_in_quoted_string_ignored PASSED          [ 69%]
tests/test_or_logic.py::test_and_in_quoted_string_ignored PASSED         [ 69%]
tests/test_or_logic.py::test_evaluate_simple_or_true_first PASSED        [ 69%]
tests/test_or_logic.py::test_evaluate_simple_or_true_second PASSED       [ 69%]
tests/test_or_logic.py::test_evaluate_simple_or_both_true PASSED         [ 69%]
tests/test_or_logic.py::test_evaluate_simple_or_both_false PASSED        [ 69%]
tests/test_or_logic.py::test_evaluate_simple_and_both_true PASSED        [ 69%]
tests/test_or_logic.py::test_evaluate_simple_and_first_false PASSED      [ 69%]
tests/test_or_logic.py::test_evaluate_nested_or_and PASSED               [ 69%]
tests/test_or_logic.py::test_evaluate_complex_nested PASSED              [ 69%]
tests/test_or_logic.py::test_evaluate_three_way_or PASSED                [ 69%]
tests/test_or_logic.py::test_policy_with_or_logic PASSED                 [ 69%]
tests/test_or_logic.py::test_policy_multiple_or_rules PASSED             [ 69%]
tests/test_or_logic.py::test_backward_compatibility_no_or PASSED         [ 69%]
tests/test_or_logic.py::test_or_with_array_operations PASSED             [ 69%]
tests/test_or_logic.py::test_or_with_field_existence PASSED              [ 69%]
tests/test_or_logic.py::test_or_with_comparison_operators PASSED         [ 69%]
tests/test_or_logic.py::test_or_logic_performance PASSED                 [ 69%]
tests/test_performance_regression.py::test_filter_generation_cold_performance PASSED [ 69%]
tests/test_performance_regression.py::test_filter_generation_warm_performance PASSED [ 70%]
tests/test_performance_regression.py::test_filter_generation_multi_user PASSED [ 70%]
tests/test_performance_regression.py::test_policy_evaluation_performance PASSED [ 70%]
tests/test_performance_regression.py::test_policy_evaluation_complex_conditions PASSED [ 70%]
tests/test_performance_regression.py::test_combined_overhead_performance PASSED [ 70%]
tests/test_performance_regression.py::test_cache_hit_rate_realistic_workload PASSED [ 70%]
tests/test_performance_regression.py::test_cache_lru_eviction_performance PASSED [ 70%]
tests/test_performance_regression.py::test_condition_compilation_time PASSED [ 70%]
tests/test_performance_regression.py::test_role_set_lookup_performance PASSED [ 70%]
tests/test_performance_regression.py::test_performance_summary PASSED    [ 70%]
tests/test_pgvector_advanced.py::test_pgvector_health_check_success PASSED [ 70%]
tests/test_pgvector_advanced.py::test_pgvector_context_manager PASSED    [ 70%]
tests/test_pgvector_advanced.py::test_pgvector_with_validation PASSED    [ 70%]
tests/test_pgvector_advanced.py::test_pgvector_with_retry PASSED         [ 70%]
tests/test_pgvector_advanced.py::test_pgvector_with_cache PASSED         [ 70%]
tests/test_pgvector_advanced.py::test_pgvector_with_audit_logging PASSED [ 70%]
tests/test_pgvector_advanced.py::test_pgvector_search_failure PASSED     [ 70%]
tests/test_pgvector_advanced.py::test_pgvector_empty_results PASSED      [ 70%]
tests/test_pgvector_advanced.py::test_pgvector_batch_search PASSED       [ 70%]
tests/test_pgvector_advanced.py::test_pgvector_policy_update PASSED      [ 71%]
tests/test_pgvector_advanced.py::test_pgvector_with_embed_fn PASSED      [ 71%]
tests/test_pgvector_advanced.py::test_pgvector_text_query_without_embed_fn PASSED [ 71%]
tests/test_pgvector_native_or.py::test_pgvector_simple_or_filter PASSED  [ 71%]
tests/test_pgvector_native_or.py::test_pgvector_simple_and_filter PASSED [ 71%]
tests/test_pgvector_native_or.py::test_pgvector_nested_or_and PASSED     [ 71%]
tests/test_pgvector_native_or.py::test_pgvector_three_way_or PASSED      [ 71%]
tests/test_pgvector_native_or.py::test_pgvector_or_with_user_context PASSED [ 71%]
tests/test_pgvector_native_or.py::test_pgvector_or_with_comparison PASSED [ 71%]
tests/test_pgvector_native_or.py::test_pgvector_or_with_array PASSED     [ 71%]
tests/test_pgvector_native_or.py::test_pgvector_backward_compat PASSED   [ 71%]
tests/test_pgvector_native_or.py::test_pgvector_complex_nested PASSED    [ 71%]
tests/test_pgvector_retriever.py::test_pgvector_retriever_initialization PASSED [ 71%]
tests/test_pgvector_retriever.py::test_pgvector_retriever_custom_embedding_column PASSED [ 71%]
tests/test_pgvector_retriever.py::test_pgvector_retriever_search_with_filter PASSED [ 71%]
tests/test_pgvector_retriever.py::test_pgvector_retriever_search_with_text PASSED [ 71%]
tests/test_pgvector_retriever.py::test_pgvector_retriever_sql_generation PASSED [ 71%]
tests/test_pgvector_retriever.py::test_pgvector_retriever_different_distance_operators PASSED [ 71%]
tests/test_pgvector_retriever.py::test_pgvector_retriever_dict_cursor PASSED [ 71%]
tests/test_pgvector_retriever.py::test_pgvector_retriever_regular_cursor_conversion PASSED [ 71%]
tests/test_pgvector_retriever.py::test_pgvector_retriever_error_handling PASSED [ 72%]
tests/test_pgvector_retriever.py::test_pgvector_retriever_missing_dependency PASSED [ 72%]
tests/test_phase3_optimizations.py::test_filter_builders_preloaded PASSED [ 72%]
tests/test_phase3_optimizations.py::test_filter_builder_registry_lookup PASSED [ 72%]
tests/test_phase3_optimizations.py::test_unsupported_backend_error PASSED [ 72%]
tests/test_phase3_optimizations.py::test_role_sets_preconverted PASSED   [ 72%]
tests/test_phase3_optimizations.py::test_role_set_evaluation_correctness PASSED [ 72%]
tests/test_phase3_optimizations.py::test_role_set_with_single_role_string PASSED [ 72%]
tests/test_phase3_optimizations.py::test_role_set_with_none_roles PASSED [ 72%]
tests/test_phase3_optimizations.py::test_role_set_with_missing_roles PASSED [ 72%]
tests/test_phase3_optimizations.py::test_rule_without_roles PASSED       [ 72%]
tests/test_phase3_optimizations.py::test_all_optimizations_together PASSED [ 72%]
tests/test_phase3_optimizations.py::test_performance_with_many_roles PASSED [ 72%]
tests/test_pinecone_advanced.py::test_pinecone_health_check_success PASSED [ 72%]
tests/test_pinecone_advanced.py::test_pinecone_context_manager PASSED    [ 72%]
tests/test_pinecone_advanced.py::test_pinecone_with_validation PASSED    [ 72%]
tests/test_pinecone_advanced.py::test_pinecone_with_retry PASSED         [ 72%]
tests/test_pinecone_advanced.py::test_pinecone_with_cache PASSED         [ 72%]
tests/test_pinecone_advanced.py::test_pinecone_with_audit_logging PASSED [ 72%]
tests/test_pinecone_advanced.py::test_pinecone_search_failure PASSED     [ 73%]
tests/test_pinecone_advanced.py::test_pinecone_empty_results PASSED      [ 73%]
tests/test_pinecone_advanced.py::test_pinecone_batch_search PASSED       [ 73%]
tests/test_pinecone_advanced.py::test_pinecone_policy_update PASSED      [ 73%]
tests/test_pinecone_advanced.py::test_pinecone_with_embed_fn PASSED      [ 73%]
tests/test_pinecone_advanced.py::test_pinecone_text_query_without_embed_fn PASSED [ 73%]
tests/test_pinecone_advanced.py::test_pinecone_with_namespace PASSED     [ 73%]
tests/test_pinecone_native_or.py::test_pinecone_simple_or_filter PASSED  [ 73%]
tests/test_pinecone_native_or.py::test_pinecone_simple_and_filter PASSED [ 73%]
tests/test_pinecone_native_or.py::test_pinecone_nested_or_and PASSED     [ 73%]
tests/test_pinecone_native_or.py::test_pinecone_three_way_or PASSED      [ 73%]
tests/test_pinecone_native_or.py::test_pinecone_or_with_user_context PASSED [ 73%]
tests/test_pinecone_native_or.py::test_pinecone_complex_nested PASSED    [ 73%]
tests/test_pinecone_native_or.py::test_pinecone_backward_compat_simple_condition PASSED [ 73%]
tests/test_pinecone_native_or.py::test_pinecone_or_with_field_existence PASSED [ 73%]
tests/test_pinecone_native_or.py::test_pinecone_or_with_comparison PASSED [ 73%]
tests/test_pinecone_native_or.py::test_pinecone_or_with_array_operations PASSED [ 73%]
tests/test_pinecone_retriever.py::test_pinecone_retriever_initialization PASSED [ 73%]
tests/test_pinecone_retriever.py::test_pinecone_retriever_missing_dependency PASSED [ 73%]
tests/test_pinecone_retriever.py::test_pinecone_retriever_search_with_filter PASSED [ 74%]
tests/test_pinecone_retriever.py::test_pinecone_retriever_dict_response PASSED [ 74%]
tests/test_pinecone_retriever.py::test_pinecone_retriever_no_results PASSED [ 74%]
tests/test_pinecone_retriever.py::test_pinecone_retriever_with_vector_query PASSED [ 74%]
tests/test_pinecone_retriever.py::test_pinecone_retriever_with_namespace_override PASSED [ 74%]
tests/test_pinecone_retriever.py::test_pinecone_retriever_with_sparse_vector PASSED [ 74%]
tests/test_pinecone_retriever.py::test_pinecone_retriever_search_error PASSED [ 74%]
tests/test_pinecone_retriever.py::test_pinecone_retriever_include_values PASSED [ 74%]
tests/test_plugins.py::TestPluginRegistry::test_register_audit_sink PASSED [ 74%]
tests/test_plugins.py::TestPluginRegistry::test_get_audit_sink PASSED    [ 74%]
tests/test_plugins.py::TestPluginRegistry::test_get_audit_sink_not_found PASSED [ 74%]
tests/test_plugins.py::TestPluginRegistry::test_register_invalid_audit_sink PASSED [ 74%]
tests/test_plugins.py::TestPluginRegistry::test_register_cache_backend PASSED [ 74%]
tests/test_plugins.py::TestPluginRegistry::test_get_cache_backend PASSED [ 74%]
tests/test_plugins.py::TestPluginRegistry::test_get_cache_backend_not_found PASSED [ 74%]
tests/test_plugins.py::TestPluginRegistry::test_register_invalid_cache_backend PASSED [ 74%]
tests/test_plugins.py::TestPluginRegistry::test_register_attribute_provider PASSED [ 74%]
tests/test_plugins.py::TestPluginRegistry::test_get_attribute_provider PASSED [ 74%]
tests/test_plugins.py::TestPluginRegistry::test_get_attribute_provider_not_found PASSED [ 74%]
tests/test_plugins.py::TestPluginRegistry::test_list_all_plugins PASSED  [ 75%]
tests/test_plugins.py::TestPluginRegistry::test_replace_existing_plugin PASSED [ 75%]
tests/test_policy_engine.py::test_evaluate_everyone_rule PASSED          [ 75%]
tests/test_policy_engine.py::test_evaluate_role_based PASSED             [ 75%]
tests/test_policy_engine.py::test_evaluate_department_condition PASSED   [ 75%]
tests/test_policy_engine.py::test_evaluate_in_condition PASSED           [ 75%]
tests/test_policy_engine.py::test_evaluate_multiple_rules PASSED         [ 75%]
tests/test_policy_engine.py::test_evaluate_match_conditions PASSED       [ 75%]
tests/test_policy_engine.py::test_evaluate_nested_attributes PASSED      [ 75%]
tests/test_policy_engine.py::test_evaluate_default_allow PASSED          [ 75%]
tests/test_policy_engine.py::test_evaluate_combined_roles_and_conditions PASSED [ 75%]
tests/test_policy_engine_advanced.py::test_policy_engine_list_value_not_in PASSED [ 75%]
tests/test_policy_engine_advanced.py::test_policy_engine_single_string_role PASSED [ 75%]
tests/test_policy_engine_advanced.py::test_policy_engine_no_checks_specified PASSED [ 75%]
tests/test_policy_engine_advanced.py::test_policy_engine_not_in_condition PASSED [ 75%]
tests/test_policy_engine_advanced.py::test_policy_engine_not_in_non_list PASSED [ 75%]
tests/test_policy_engine_advanced.py::test_policy_engine_in_non_list PASSED [ 75%]
tests/test_policy_engine_advanced.py::test_policy_engine_not_equal_condition PASSED [ 75%]
tests/test_policy_engine_advanced.py::test_policy_engine_unsupported_operator PASSED [ 75%]
tests/test_policy_engine_advanced.py::test_policy_engine_literal_string PASSED [ 76%]
tests/test_policy_engine_advanced.py::test_policy_engine_literal_number PASSED [ 76%]
tests/test_policy_engine_advanced.py::test_policy_engine_literal_float PASSED [ 76%]
tests/test_policy_engine_advanced.py::test_policy_engine_literal_boolean PASSED [ 76%]
tests/test_policy_engine_advanced.py::test_policy_engine_nested_value_not_dict PASSED [ 76%]
tests/test_policy_engine_advanced.py::test_policy_engine_to_filter_unsupported_backend PASSED [ 76%]
tests/test_policy_engine_coverage.py::TestPolicyEngineExplainMethods::test_evaluate_with_explanation_explicit_allow PASSED [ 76%]
tests/test_policy_engine_coverage.py::TestPolicyEngineExplainMethods::test_evaluate_with_explanation_explicit_deny PASSED [ 76%]
tests/test_policy_engine_coverage.py::TestPolicyEngineExplainMethods::test_evaluate_with_explanation_catch_all PASSED [ 76%]
tests/test_policy_engine_coverage.py::TestPolicyEngineExplainMethods::test_evaluate_with_explanation_default_applied PASSED [ 76%]
tests/test_policy_engine_coverage.py::TestPolicyEngineExplainMethods::test_explain_document_match_list_values PASSED [ 76%]
tests/test_policy_engine_coverage.py::TestPolicyEngineExplainMethods::test_explain_user_allowed_no_roles_match PASSED [ 76%]
tests/test_policy_engine_coverage.py::TestPolicyEngineExplainMethods::test_explain_user_allowed_roles_as_string PASSED [ 76%]
tests/test_policy_engine_coverage.py::TestPolicyEngineExplainMethods::test_explain_user_allowed_roles_none PASSED [ 76%]
tests/test_policy_engine_coverage.py::TestPolicyEngineExplainMethods::test_explain_user_allowed_with_conditions PASSED [ 76%]
tests/test_policy_engine_coverage.py::TestPolicyEngineExplainMethods::test_explain_user_allowed_roles_and_conditions PASSED [ 76%]
tests/test_policy_engine_coverage.py::TestPolicyEngineEvaluateCondition::test_evaluate_condition_not_in PASSED [ 76%]
tests/test_policy_engine_coverage.py::TestPolicyEngineEvaluateCondition::test_evaluate_condition_in_operator PASSED [ 76%]
tests/test_policy_engine_coverage.py::TestPolicyEngineEvaluateCondition::test_evaluate_condition_not_equals PASSED [ 76%]
tests/test_policy_engine_coverage.py::TestPolicyEngineEvaluateCondition::test_evaluate_condition_equals_with_none PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineEvaluateCondition::test_evaluate_condition_not_equals_with_none PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineEvaluateCondition::test_evaluate_condition_in_non_list PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineResolveValue::test_resolve_value_user_field PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineResolveValue::test_resolve_value_document_field PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineResolveValue::test_resolve_value_quoted_strings PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineResolveValue::test_resolve_value_numbers PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineResolveValue::test_resolve_value_booleans PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineResolveValue::test_resolve_value_list_literals PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineResolveValue::test_resolve_value_unquoted_string PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineBuildFilter::test_build_filter_empty_backend PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineBuildFilter::test_build_filter_none_backend PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineBuildFilter::test_build_filter_backend_name_too_long PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineBuildFilter::test_build_filter_invalid_characters PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineBuildFilter::test_build_filter_unsupported_backend PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineBuildFilter::test_build_filter_faiss_returns_none PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineCacheAndStats::test_cache_stats_disabled PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineCacheAndStats::test_was_last_call_cache_hit PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineCacheAndStats::test_invalidate_cache PASSED [ 77%]
tests/test_policy_engine_coverage.py::TestPolicyEngineCompilationErrors::test_unsupported_operator_in_evaluate PASSED [ 78%]
tests/test_policy_explain.py::test_explain_simple_allow PASSED           [ 78%]
tests/test_policy_explain.py::test_explain_simple_deny PASSED            [ 78%]
tests/test_policy_explain.py::test_explain_or_condition PASSED           [ 78%]
tests/test_policy_explain.py::test_explain_complex_nested PASSED         [ 78%]
tests/test_policy_explain.py::test_explain_explicit_rule_match PASSED    [ 78%]
tests/test_policy_explain.py::test_explain_multiple_rules PASSED         [ 78%]
tests/test_policy_explain.py::test_explain_roles_and_conditions PASSED   [ 78%]
tests/test_policy_models_complete.py::test_allow_conditions_is_empty PASSED [ 78%]
tests/test_policy_models_complete.py::test_rule_match_validation_dict_value PASSED [ 78%]
tests/test_policy_models_complete.py::test_rule_match_validation_list_value PASSED [ 78%]
tests/test_policy_parser.py::test_parse_valid_policy_from_dict PASSED    [ 78%]
tests/test_policy_parser.py::test_parse_policy_from_file PASSED          [ 78%]
tests/test_policy_parser.py::test_parse_policy_missing_version PASSED    [ 78%]
tests/test_policy_parser.py::test_parse_policy_unsupported_version PASSED [ 78%]
tests/test_policy_parser.py::test_parse_policy_no_rules PASSED           [ 78%]
tests/test_policy_parser.py::test_parse_policy_invalid_condition PASSED  [ 78%]
tests/test_policy_parser.py::test_parse_policy_file_not_found PASSED     [ 78%]
tests/test_policy_parser.py::test_parse_policy_invalid_yaml PASSED       [ 78%]
tests/test_policy_parser.py::test_parse_policy_with_all_features PASSED  [ 78%]
tests/test_policy_parser_complete.py::test_policy_parser_file_read_error PASSED [ 79%]
tests/test_policy_parser_complete.py::test_policy_parser_empty_yaml_file PASSED [ 79%]
tests/test_policy_parser_complete.py::test_policy_parser_from_dict_unexpected_error PASSED [ 79%]
tests/test_policy_parser_complete.py::test_policy_parser_from_yaml_string PASSED [ 79%]
tests/test_policy_parser_complete.py::test_policy_parser_from_yaml_string_invalid_yaml PASSED [ 79%]
tests/test_policy_parser_complete.py::test_policy_parser_from_yaml_string_empty PASSED [ 79%]
tests/test_policy_parser_complete.py::test_policy_parser_from_yaml_string_none PASSED [ 79%]
tests/test_policy_parser_complete.py::test_load_policy_convenience_function PASSED [ 79%]
tests/test_policy_parser_complete.py::test_policy_parser_yaml_with_comments PASSED [ 79%]
tests/test_policy_parser_complete.py::test_policy_parser_complex_yaml PASSED [ 79%]
tests/test_policy_resolvers.py::test_role_hierarchy_resolver_direct_role PASSED [ 79%]
tests/test_policy_resolvers.py::test_role_hierarchy_resolver_inherited_role PASSED [ 79%]
tests/test_policy_resolvers.py::test_role_hierarchy_resolver_admin_has_all PASSED [ 79%]
tests/test_policy_resolvers.py::test_role_hierarchy_resolver_no_match PASSED [ 79%]
tests/test_policy_resolvers.py::test_role_hierarchy_resolver_single_string_role PASSED [ 79%]
tests/test_policy_resolvers.py::test_role_hierarchy_resolver_get_filter_params PASSED [ 79%]
tests/test_policy_resolvers.py::test_organization_resolver_single_org PASSED [ 79%]
tests/test_policy_resolvers.py::test_organization_resolver_multiple_orgs PASSED [ 79%]
tests/test_policy_resolvers.py::test_organization_resolver_no_orgs PASSED [ 79%]
tests/test_policy_resolvers.py::test_organization_resolver_no_user_id PASSED [ 80%]
tests/test_policy_resolvers.py::test_organization_resolver_custom_field PASSED [ 80%]
tests/test_policy_resolvers.py::test_graph_permission_resolver_check_permission PASSED [ 80%]
tests/test_policy_resolvers.py::test_graph_permission_resolver_deny PASSED [ 80%]
tests/test_policy_resolvers.py::test_graph_permission_resolver_with_groups PASSED [ 80%]
tests/test_policy_resolvers.py::test_graph_permission_resolver_no_groups_func PASSED [ 80%]
tests/test_policy_resolvers.py::test_graph_permission_resolver_missing_resource PASSED [ 80%]
tests/test_policy_resolvers.py::test_time_based_resolver_always_allows PASSED [ 80%]
tests/test_policy_resolvers.py::test_time_based_resolver_adds_time_filter PASSED [ 80%]
tests/test_policy_resolvers.py::test_time_based_resolver_default_time PASSED [ 80%]
tests/test_policy_resolvers.py::test_composite_resolver_all_approve PASSED [ 80%]
tests/test_policy_resolvers.py::test_composite_resolver_one_denies PASSED [ 80%]
tests/test_policy_resolvers.py::test_composite_resolver_merge_params PASSED [ 80%]
tests/test_policy_resolvers.py::test_composite_resolver_explicit_deny PASSED [ 80%]
tests/test_policy_resolvers.py::test_composite_resolver_empty_list PASSED [ 80%]
tests/test_policy_validator.py::test_valid_policy_no_issues PASSED       [ 80%]
tests/test_policy_validator.py::test_policy_with_no_rules PASSED         [ 80%]
tests/test_policy_validator.py::test_duplicate_rule_names PASSED         [ 80%]
tests/test_policy_validator.py::test_rule_with_no_allow_conditions PASSED [ 80%]
tests/test_policy_validator.py::test_single_equals_in_condition PASSED   [ 81%]
tests/test_policy_validator.py::test_malformed_field_access PASSED       [ 81%]
tests/test_policy_validator.py::test_none_comparison_warning PASSED      [ 81%]
tests/test_policy_validator.py::test_double_underscore_security_risk PASSED [ 81%]
tests/test_policy_validator.py::test_too_many_rules_warning PASSED       [ 81%]
tests/test_policy_validator.py::test_too_many_conditions_per_rule PASSED [ 81%]
tests/test_policy_validator.py::test_everyone_rule_without_match_filter PASSED [ 81%]
tests/test_policy_validator.py::test_everyone_rule_shadows_later_rules PASSED [ 81%]
tests/test_policy_validator.py::test_allow_by_default_warning PASSED     [ 81%]
tests/test_policy_validator.py::test_rule_without_user_reference PASSED  [ 81%]
tests/test_policy_validator.py::test_validate_policy_raises_on_error PASSED [ 81%]
tests/test_policy_validator.py::test_validate_policy_no_raise PASSED     [ 81%]
tests/test_policy_validator.py::test_strict_mode_treats_warnings_as_errors PASSED [ 81%]
tests/test_policy_validator.py::test_validation_issue_str_formatting PASSED [ 81%]
tests/test_policy_validator.py::test_print_validation_issues_no_issues PASSED [ 81%]
tests/test_policy_validator.py::test_print_validation_issues_with_errors PASSED [ 81%]
tests/test_policy_validator.py::test_complex_policy_validation PASSED    [ 81%]
tests/test_qdrant_advanced.py::test_qdrant_health_check_success PASSED   [ 81%]
tests/test_qdrant_advanced.py::test_qdrant_context_manager PASSED        [ 81%]
tests/test_qdrant_advanced.py::test_qdrant_with_validation PASSED        [ 82%]
tests/test_qdrant_advanced.py::test_qdrant_with_retry PASSED             [ 82%]
tests/test_qdrant_advanced.py::test_qdrant_with_cache PASSED             [ 82%]
tests/test_qdrant_advanced.py::test_qdrant_with_audit_logging PASSED     [ 82%]
tests/test_qdrant_advanced.py::test_qdrant_search_failure PASSED         [ 82%]
tests/test_qdrant_advanced.py::test_qdrant_empty_results PASSED          [ 82%]
tests/test_qdrant_advanced.py::test_qdrant_batch_search PASSED           [ 82%]
tests/test_qdrant_advanced.py::test_qdrant_policy_update PASSED          [ 82%]
tests/test_qdrant_advanced.py::test_qdrant_with_embed_fn PASSED          [ 82%]
tests/test_qdrant_advanced.py::test_qdrant_text_query_without_embed_fn PASSED [ 82%]
tests/test_qdrant_advanced.py::test_qdrant_invalidate_cache PASSED       [ 82%]
tests/test_qdrant_advanced.py::test_qdrant_with_newer_api PASSED         [ 82%]
tests/test_qdrant_native_or.py::test_qdrant_simple_or_filter PASSED      [ 82%]
tests/test_qdrant_native_or.py::test_qdrant_simple_and_filter PASSED     [ 82%]
tests/test_qdrant_native_or.py::test_qdrant_nested_or_and_filter PASSED  [ 82%]
tests/test_qdrant_native_or.py::test_qdrant_three_way_or PASSED          [ 82%]
tests/test_qdrant_native_or.py::test_qdrant_or_with_user_context PASSED  [ 82%]
tests/test_qdrant_native_or.py::test_qdrant_complex_nested PASSED        [ 82%]
tests/test_qdrant_native_or.py::test_qdrant_backward_compat_simple_condition PASSED [ 82%]
tests/test_qdrant_native_or.py::test_qdrant_or_with_field_existence PASSED [ 83%]
tests/test_qdrant_native_or.py::test_qdrant_or_with_comparison PASSED    [ 83%]
tests/test_qdrant_native_or.py::test_qdrant_or_with_array_operations PASSED [ 83%]
tests/test_qdrant_retriever.py::TestQdrantSecureRetriever::test_search_public_documents PASSED [ 83%]
tests/test_qdrant_retriever.py::TestQdrantSecureRetriever::test_search_department_documents PASSED [ 83%]
tests/test_qdrant_retriever.py::TestQdrantSecureRetriever::test_search_admin_access PASSED [ 83%]
tests/test_qdrant_retriever.py::TestQdrantSecureRetriever::test_search_no_access PASSED [ 83%]
tests/test_qdrant_retriever.py::TestQdrantSecureRetriever::test_backend_name PASSED [ 83%]
tests/test_qdrant_retriever_complete.py::test_qdrant_retriever_missing_dependency PASSED [ 83%]
tests/test_qdrant_retriever_complete.py::test_qdrant_retriever_wrong_client_type PASSED [ 83%]
tests/test_qdrant_retriever_complete.py::test_qdrant_retriever_old_api_fallback PASSED [ 83%]
tests/test_qdrant_retriever_complete.py::test_qdrant_retriever_search_exception PASSED [ 83%]
tests/test_resource_cleanup.py::TestSharedExecutorLifecycle::test_get_shared_executor_creates_singleton PASSED [ 83%]
tests/test_resource_cleanup.py::TestSharedExecutorLifecycle::test_get_shared_executor_default_workers PASSED [ 83%]
tests/test_resource_cleanup.py::TestSharedExecutorLifecycle::test_get_shared_executor_custom_workers PASSED [ 83%]
tests/test_resource_cleanup.py::TestSharedExecutorLifecycle::test_shutdown_executor_cleans_up PASSED [ 83%]
tests/test_resource_cleanup.py::TestSharedExecutorLifecycle::test_shutdown_executor_allows_recreation PASSED [ 83%]
tests/test_resource_cleanup.py::TestSharedExecutorLifecycle::test_shutdown_idempotent PASSED [ 83%]
tests/test_resource_cleanup.py::TestSharedExecutorLifecycle::test_executor_thread_naming PASSED [ 83%]
tests/test_resource_cleanup.py::TestSharedExecutorLifecycle::test_executor_with_async_operation PASSED [ 84%]
tests/test_resource_cleanup.py::TestSharedExecutorLifecycle::test_executor_concurrent_tasks PASSED [ 84%]
tests/test_resource_cleanup.py::TestFilterCacheCleanup::test_cache_creation_with_max_size PASSED [ 84%]
tests/test_resource_cleanup.py::TestFilterCacheCleanup::test_cache_clear PASSED [ 84%]
tests/test_resource_cleanup.py::TestFilterCacheCleanup::test_cache_lru_eviction PASSED [ 84%]
tests/test_resource_cleanup.py::TestEnvironmentVariableConfiguration::test_env_bool_true_values PASSED [ 84%]
tests/test_resource_cleanup.py::TestEnvironmentVariableConfiguration::test_env_bool_false_values PASSED [ 84%]
tests/test_resource_cleanup.py::TestEnvironmentVariableConfiguration::test_env_bool_default PASSED [ 84%]
tests/test_resource_cleanup.py::TestEnvironmentVariableConfiguration::test_env_bool_empty_string PASSED [ 84%]
tests/test_resource_cleanup.py::TestEnvironmentVariableConfiguration::test_env_int_valid PASSED [ 84%]
tests/test_resource_cleanup.py::TestEnvironmentVariableConfiguration::test_env_int_invalid PASSED [ 84%]
tests/test_resource_cleanup.py::TestEnvironmentVariableConfiguration::test_env_int_default PASSED [ 84%]
tests/test_resource_cleanup.py::TestEnvironmentVariableConfiguration::test_env_float_valid PASSED [ 84%]
tests/test_resource_cleanup.py::TestEnvironmentVariableConfiguration::test_env_float_invalid PASSED [ 84%]
tests/test_resource_cleanup.py::TestEnvironmentVariableConfiguration::test_env_float_default PASSED [ 84%]
tests/test_resource_cleanup.py::TestEnvironmentVariableConfiguration::test_env_str_value PASSED [ 84%]
tests/test_resource_cleanup.py::TestEnvironmentVariableConfiguration::test_env_str_default PASSED [ 84%]
tests/test_resource_cleanup.py::TestSecureRetrieverConfigFromEnv::test_from_env_default_values PASSED [ 84%]
tests/test_resource_cleanup.py::TestSecureRetrieverConfigFromEnv::test_from_env_custom_values PASSED [ 84%]
tests/test_resource_cleanup.py::TestSecureRetrieverConfigFromEnv::test_from_env_validation_config PASSED [ 85%]
tests/test_resource_cleanup.py::TestSecureRetrieverConfigFromEnv::test_from_env_partial_override PASSED [ 85%]
tests/test_resource_cleanup.py::TestRetryConfigWithTimeouts::test_default_timeouts PASSED [ 85%]
tests/test_resource_cleanup.py::TestRetryConfigWithTimeouts::test_custom_timeouts PASSED [ 85%]
tests/test_resource_cleanup.py::TestRetryConfigWithTimeouts::test_timeout_in_from_env_config PASSED [ 85%]
tests/test_resource_cleanup.py::TestResourceCleanupIntegration::test_async_operations_cleanup PASSED [ 85%]
tests/test_resource_cleanup.py::TestResourceCleanupIntegration::test_cache_and_executor_independent PASSED [ 85%]
tests/test_retry.py::TestRetryConfig::test_default_config PASSED         [ 85%]
tests/test_retry.py::TestRetryConfig::test_custom_config PASSED          [ 85%]
tests/test_retry.py::TestRetryConfig::test_calculate_delay_exponential PASSED [ 85%]
tests/test_retry.py::TestRetryConfig::test_calculate_delay_with_jitter PASSED [ 85%]
tests/test_retry.py::TestRetryConfig::test_custom_retry_exceptions PASSED [ 85%]
tests/test_retry.py::TestRetryOnFailureDecorator::test_successful_call_no_retry PASSED [ 85%]
tests/test_retry.py::TestRetryOnFailureDecorator::test_retry_on_connection_error PASSED [ 85%]
tests/test_retry.py::TestRetryOnFailureDecorator::test_max_retries_exceeded PASSED [ 85%]
tests/test_retry.py::TestRetryOnFailureDecorator::test_non_retryable_exception_immediate_raise PASSED [ 85%]
tests/test_retry.py::TestRetryOnFailureDecorator::test_retry_different_exception_types PASSED [ 85%]
tests/test_retry.py::TestRetryOnFailureDecorator::test_custom_retry_exceptions PASSED [ 85%]
tests/test_retry.py::TestAsyncRetryOnFailureDecorator::test_async_successful_call_no_retry PASSED [ 85%]
tests/test_retry.py::TestAsyncRetryOnFailureDecorator::test_async_retry_on_connection_error PASSED [ 85%]
tests/test_retry.py::TestAsyncRetryOnFailureDecorator::test_async_max_retries_exceeded PASSED [ 86%]
tests/test_retry.py::TestAsyncRetryOnFailureDecorator::test_async_non_retryable_exception PASSED [ 86%]
tests/test_retry.py::TestRetryableOperation::test_retryable_operation_success PASSED [ 86%]
tests/test_retry.py::TestRetryableOperation::test_retryable_operation_with_retries PASSED [ 86%]
tests/test_retry.py::TestRetryableOperation::test_retryable_operation_max_retries_exceeded PASSED [ 86%]
tests/test_retry.py::TestRetryableOperation::test_retryable_operation_non_retryable_error PASSED [ 86%]
tests/test_retry.py::TestRetryableOperation::test_retryable_operation_context_manager_suppression PASSED [ 86%]
tests/test_stability.py::test_no_memory_leak_filter_generation PASSED    [ 86%]
tests/test_stability.py::test_no_memory_leak_policy_evaluation PASSED    [ 86%]
tests/test_stability.py::test_performance_stability_over_time PASSED     [ 86%]
tests/test_stability.py::test_cache_stability_under_load PASSED          [ 86%]
tests/test_stability.py::test_extended_stability SKIPPED (Skipping
extended test (use --stability-full to run))                             [ 86%]
tests/test_stress.py::TestPolicyLimits::test_max_rules_limit PASSED      [ 86%]
tests/test_stress.py::TestPolicyLimits::test_max_conditions_per_rule_limit PASSED [ 86%]
tests/test_stress.py::TestPolicyLimits::test_max_total_conditions_limit PASSED [ 86%]
tests/test_stress.py::TestPolicyLimits::test_max_list_size_limit PASSED  [ 86%]
tests/test_stress.py::TestPolicyLimits::test_max_list_size_bytes_limit PASSED [ 86%]
tests/test_stress.py::TestPolicyLimits::test_max_policy_size_bytes_limit PASSED [ 86%]
tests/test_stress.py::TestPolicyLimits::test_max_nesting_depth_limit PASSED [ 86%]
tests/test_stress.py::TestPerformance::test_large_rule_set_performance PASSED [ 87%]
tests/test_stress.py::TestPerformance::test_complex_conditions_performance PASSED [ 87%]
tests/test_stress.py::TestPerformance::test_concurrent_policy_evaluation PASSED [ 87%]
tests/test_stress.py::TestPerformance::test_filter_generation_performance PASSED [ 87%]
tests/test_stress.py::TestEdgeCases::test_empty_user_context PASSED      [ 87%]
tests/test_stress.py::TestEdgeCases::test_very_long_field_names PASSED   [ 87%]
tests/test_stress.py::TestEdgeCases::test_very_long_field_values PASSED  [ 87%]
tests/test_stress.py::TestEdgeCases::test_unicode_field_names_and_values PASSED [ 87%]
tests/test_stress.py::TestEdgeCases::test_special_characters_in_values PASSED [ 87%]
tests/test_stress.py::TestEdgeCases::test_numeric_field_edge_cases PASSED [ 87%]
tests/test_stress.py::TestEdgeCases::test_deeply_nested_field_access PASSED [ 87%]
tests/test_stress.py::TestEdgeCases::test_list_with_many_elements PASSED [ 87%]
tests/test_stress.py::TestEdgeCases::test_missing_fields_at_various_depths PASSED [ 87%]
tests/test_stress.py::TestMemoryUsage::test_policy_reuse PASSED          [ 87%]
tests/test_stress.py::TestMemoryUsage::test_filter_generation_reuse PASSED [ 87%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_qdrant_basic PASSED [ 87%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_qdrant_with_vector PASSED [ 87%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_qdrant_no_payload PASSED [ 87%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_chromadb_basic PASSED [ 87%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_chromadb_no_distance PASSED [ 88%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_chromadb_none_distance PASSED [ 88%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_pinecone_basic PASSED [ 88%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_pinecone_no_metadata PASSED [ 88%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_weaviate_basic PASSED [ 88%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_weaviate_with_distance PASSED [ 88%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_weaviate_no_additional PASSED [ 88%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_weaviate_no_score PASSED [ 88%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_dict_basic PASSED [ 88%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_dict_alternate_fields PASSED [ 88%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_dict_content_field PASSED [ 88%]
tests/test_types_coverage.py::TestStandardSearchResultConversions::test_from_dict_empty PASSED [ 88%]
tests/test_types_coverage.py::TestValidateVectorDimension::test_valid_dimension PASSED [ 88%]
tests/test_types_coverage.py::TestValidateVectorDimension::test_invalid_dimension_too_short PASSED [ 88%]
tests/test_types_coverage.py::TestValidateVectorDimension::test_invalid_dimension_too_long PASSED [ 88%]
tests/test_types_coverage.py::TestValidateVectorDimension::test_custom_context PASSED [ 88%]
tests/test_types_coverage.py::TestProtocolTypes::test_filter_object_protocol PASSED [ 88%]
tests/test_types_coverage.py::TestProtocolTypes::test_vector_database_client_protocol PASSED [ 88%]
tests/test_types_coverage.py::TestProtocolTypes::test_has_model_dump_protocol PASSED [ 88%]
tests/test_types_coverage.py::TestSearchResultTypedDict::test_search_result_creation PASSED [ 89%]
tests/test_types_coverage.py::TestSearchResultTypedDict::test_search_result_partial PASSED [ 89%]
tests/test_utils.py::TestStripPrefixes::test_strip_user_prefix_with_prefix PASSED [ 89%]
tests/test_utils.py::TestStripPrefixes::test_strip_user_prefix_without_prefix PASSED [ 89%]
tests/test_utils.py::TestStripPrefixes::test_strip_document_prefix_with_prefix PASSED [ 89%]
tests/test_utils.py::TestStripPrefixes::test_strip_document_prefix_without_prefix PASSED [ 89%]
tests/test_utils.py::TestStripPrefixes::test_strip_field_prefix_user PASSED [ 89%]
tests/test_utils.py::TestStripPrefixes::test_strip_field_prefix_document PASSED [ 89%]
tests/test_utils.py::TestStripPrefixes::test_strip_field_prefix_unknown PASSED [ 89%]
tests/test_utils.py::TestFieldChecks::test_is_user_field PASSED          [ 89%]
tests/test_utils.py::TestFieldChecks::test_is_document_field PASSED      [ 89%]
tests/test_utils.py::TestNestedValue::test_get_nested_value_simple PASSED [ 89%]
tests/test_utils.py::TestNestedValue::test_get_nested_value_nested PASSED [ 89%]
tests/test_utils.py::TestNestedValue::test_get_nested_value_missing PASSED [ 89%]
tests/test_utils.py::TestNestedValue::test_get_nested_value_empty PASSED [ 89%]
tests/test_utils.py::TestNestedValue::test_set_nested_value_simple PASSED [ 89%]
tests/test_utils.py::TestNestedValue::test_set_nested_value_nested PASSED [ 89%]
tests/test_utils.py::TestNestedValue::test_set_nested_value_existing PASSED [ 89%]
tests/test_utils.py::TestParseLiteralValue::test_parse_string_single_quotes PASSED [ 89%]
tests/test_utils.py::TestParseLiteralValue::test_parse_string_double_quotes PASSED [ 90%]
tests/test_utils.py::TestParseLiteralValue::test_parse_numbers PASSED    [ 90%]
tests/test_utils.py::TestParseLiteralValue::test_parse_booleans PASSED   [ 90%]
tests/test_utils.py::TestParseLiteralValue::test_parse_none PASSED       [ 90%]
tests/test_utils.py::TestParseLiteralValue::test_parse_list PASSED       [ 90%]
tests/test_utils.py::TestParseLiteralValue::test_parse_unknown PASSED    [ 90%]
tests/test_utils.py::TestParseListLiteral::test_parse_string_list PASSED [ 90%]
tests/test_utils.py::TestParseListLiteral::test_parse_number_list PASSED [ 90%]
tests/test_utils.py::TestParseListLiteral::test_parse_empty_list PASSED  [ 90%]
tests/test_utils.py::TestParseListLiteral::test_parse_invalid_list PASSED [ 90%]
tests/test_utils.py::TestSanitizeFieldName::test_valid_field_names PASSED [ 90%]
tests/test_utils.py::TestSanitizeFieldName::test_invalid_characters PASSED [ 90%]
tests/test_utils.py::TestSanitizeFieldName::test_sql_injection_patterns PASSED [ 90%]
tests/test_utils.py::TestTruncateString::test_no_truncation_needed PASSED [ 90%]
tests/test_utils.py::TestTruncateString::test_truncation PASSED          [ 90%]
tests/test_utils.py::TestTruncateString::test_custom_suffix PASSED       [ 90%]
tests/test_utils.py::TestFormatDuration::test_format_duration_ms PASSED  [ 90%]
tests/test_utils.py::TestPolicyVersion::test_valid_versions PASSED       [ 90%]
tests/test_utils.py::TestPolicyVersion::test_invalid_versions PASSED     [ 90%]
tests/test_utils.py::TestDeepMerge::test_simple_merge PASSED             [ 91%]
tests/test_utils.py::TestDeepMerge::test_nested_merge PASSED             [ 91%]
tests/test_utils.py::TestDeepMerge::test_override_nested PASSED          [ 91%]
tests/test_utils.py::TestDeepMerge::test_original_unchanged PASSED       [ 91%]
tests/test_utils.py::TestSecureCompare::test_equal_strings PASSED        [ 91%]
tests/test_utils.py::TestSecureCompare::test_unequal_strings PASSED      [ 91%]
tests/test_utils.py::TestSecureCompare::test_unicode_strings PASSED      [ 91%]
tests/test_utils.py::TestSecureCompare::test_none_values PASSED          [ 91%]
tests/test_utils.py::TestSecureCompare::test_integers PASSED             [ 91%]
tests/test_utils.py::TestSecureCompare::test_floats PASSED               [ 91%]
tests/test_utils.py::TestSecureCompare::test_booleans PASSED             [ 91%]
tests/test_utils.py::TestSecureCompare::test_lists PASSED                [ 91%]
tests/test_utils.py::TestSecureCompare::test_mixed_types PASSED          [ 91%]
tests/test_utils.py::TestSecureContains::test_string_in_list PASSED      [ 91%]
tests/test_utils.py::TestSecureContains::test_integer_in_list PASSED     [ 91%]
tests/test_utils.py::TestSecureContains::test_empty_list PASSED          [ 91%]
tests/test_utils.py::TestSecureContains::test_not_a_list PASSED          [ 91%]
tests/test_utils.py::TestSecureContains::test_unicode_in_list PASSED     [ 91%]
tests/test_utils.py::TestSecureContains::test_case_sensitivity PASSED    [ 91%]
tests/test_validation.py::test_valid_user_context PASSED                 [ 92%]
tests/test_validation.py::test_valid_document_context PASSED             [ 92%]
tests/test_validation.py::test_empty_user_context PASSED                 [ 92%]
tests/test_validation.py::test_empty_document_context PASSED             [ 92%]
tests/test_validation.py::test_non_dict_user_context PASSED              [ 92%]
tests/test_validation.py::test_non_dict_document_context PASSED          [ 92%]
tests/test_validation.py::test_dangerous_field_name_double_underscore PASSED [ 92%]
tests/test_validation.py::test_dangerous_field_name_dollar_sign PASSED   [ 92%]
tests/test_validation.py::test_dangerous_field_name_semicolon PASSED     [ 92%]
tests/test_validation.py::test_dangerous_field_name_script PASSED        [ 92%]
tests/test_validation.py::test_null_byte_in_string PASSED                [ 92%]
tests/test_validation.py::test_max_string_length PASSED                  [ 92%]
tests/test_validation.py::test_max_string_length_custom PASSED           [ 92%]
tests/test_validation.py::test_max_dict_size PASSED                      [ 92%]
tests/test_validation.py::test_max_array_length PASSED                   [ 92%]
tests/test_validation.py::test_max_nesting_depth PASSED                  [ 92%]
tests/test_validation.py::test_shallow_nesting PASSED                    [ 92%]
tests/test_validation.py::test_none_values_allowed PASSED                [ 92%]
tests/test_validation.py::test_none_values_disallowed PASSED             [ 92%]
tests/test_validation.py::test_unsupported_types PASSED                  [ 92%]
tests/test_validation.py::test_valid_types PASSED                        [ 93%]
tests/test_validation.py::test_field_name_with_dots PASSED               [ 93%]
tests/test_validation.py::test_field_name_with_hyphens PASSED            [ 93%]
tests/test_validation.py::test_field_name_with_underscores PASSED        [ 93%]
tests/test_validation.py::test_field_name_empty_string PASSED            [ 93%]
tests/test_validation.py::test_field_name_special_characters PASSED      [ 93%]
tests/test_validation.py::test_non_strict_field_names PASSED             [ 93%]
tests/test_validation.py::test_retriever_validates_user_context PASSED   [ 93%]
tests/test_validation.py::test_retriever_validation_can_be_disabled PASSED [ 93%]
tests/test_validation.py::test_nested_arrays PASSED                      [ 93%]
tests/test_validation.py::test_complex_valid_structure PASSED            [ 93%]
tests/test_vector_filter_builders_extended.py::TestMilvusStringParsing::test_parse_user_equals_document PASSED [ 93%]
tests/test_vector_filter_builders_extended.py::TestMilvusStringParsing::test_parse_user_equals_document_null PASSED [ 93%]
tests/test_vector_filter_builders_extended.py::TestMilvusStringParsing::test_parse_user_equals_document_bool PASSED [ 93%]
tests/test_vector_filter_builders_extended.py::TestMilvusStringParsing::test_parse_user_equals_document_number PASSED [ 93%]
tests/test_vector_filter_builders_extended.py::TestMilvusStringParsing::test_parse_document_equals_literal_string PASSED [ 93%]
tests/test_vector_filter_builders_extended.py::TestMilvusStringParsing::test_parse_document_equals_literal_bool PASSED [ 93%]
tests/test_vector_filter_builders_extended.py::TestMilvusStringParsing::test_parse_document_equals_literal_number PASSED [ 93%]
tests/test_vector_filter_builders_extended.py::TestMilvusStringParsing::test_parse_user_in_document PASSED [ 93%]
tests/test_vector_filter_builders_extended.py::TestMilvusStringParsing::test_parse_user_in_document_null PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestMilvusStringParsing::test_parse_invalid_condition PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestMilvusCompiledExpressions::test_compiled_expression_or PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestMilvusCompiledExpressions::test_compiled_expression_and PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestMilvusCompiledExpressions::test_compiled_expression_single_child PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestMilvusCompiledExpressions::test_compiled_expression_empty PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestPgvectorStringParsing::test_parse_user_equals_document PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestPgvectorStringParsing::test_parse_user_equals_document_null PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestPgvectorStringParsing::test_parse_document_equals_literal PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestPgvectorStringParsing::test_parse_user_in_document PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestPgvectorStringParsing::test_parse_user_in_document_null PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestPgvectorStringParsing::test_parse_invalid_condition PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestPgvectorCompiledExpressions::test_compiled_expression_or PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestPgvectorCompiledExpressions::test_compiled_expression_and PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestPineconeStringParsing::test_parse_user_equals_document PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestPineconeStringParsing::test_parse_user_equals_document_null PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestPineconeStringParsing::test_parse_document_equals_literal PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestPineconeStringParsing::test_parse_user_in_document PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestPineconeCompiledExpressions::test_compiled_expression_or PASSED [ 94%]
tests/test_vector_filter_builders_extended.py::TestPineconeCompiledExpressions::test_compiled_expression_and PASSED [ 95%]
tests/test_vector_filter_builders_extended.py::TestWeaviateStringParsing::test_parse_user_equals_document PASSED [ 95%]
tests/test_vector_filter_builders_extended.py::TestWeaviateStringParsing::test_parse_user_equals_document_null PASSED [ 95%]
tests/test_vector_filter_builders_extended.py::TestWeaviateStringParsing::test_parse_document_equals_literal PASSED [ 95%]
tests/test_vector_filter_builders_extended.py::TestWeaviateStringParsing::test_parse_user_in_document PASSED [ 95%]
tests/test_vector_filter_builders_extended.py::TestWeaviateCompiledExpressions::test_compiled_expression_or PASSED [ 95%]
tests/test_vector_filter_builders_extended.py::TestWeaviateCompiledExpressions::test_compiled_expression_and PASSED [ 95%]
tests/test_weaviate.py::test_weaviate_filter_builder_basic PASSED        [ 95%]
tests/test_weaviate.py::test_weaviate_filter_builder_multiple_rules PASSED [ 95%]
tests/test_weaviate.py::test_weaviate_filter_builder_list_values PASSED  [ 95%]
tests/test_weaviate.py::test_weaviate_filter_builder_condition_equal PASSED [ 95%]
tests/test_weaviate.py::test_weaviate_filter_builder_condition_in PASSED [ 95%]
tests/test_weaviate.py::test_weaviate_filter_builder_default_allow PASSED [ 95%]
tests/test_weaviate.py::test_weaviate_filter_builder_default_deny PASSED [ 95%]
tests/test_weaviate.py::test_weaviate_filter_builder_value_types PASSED  [ 95%]
tests/test_weaviate.py::test_weaviate_retriever_initialization PASSED    [ 95%]
tests/test_weaviate.py::test_weaviate_retriever_wrong_client_type PASSED [ 95%]
tests/test_weaviate.py::test_weaviate_retriever_missing_dependency PASSED [ 95%]
tests/test_weaviate.py::test_weaviate_retriever_search PASSED            [ 95%]
tests/test_weaviate.py::test_weaviate_retriever_search_with_custom_properties PASSED [ 96%]
tests/test_weaviate.py::test_weaviate_retriever_search_with_certainty PASSED [ 96%]
tests/test_weaviate.py::test_weaviate_retriever_search_with_additional PASSED [ 96%]
tests/test_weaviate.py::test_weaviate_retriever_search_empty_results PASSED [ 96%]
tests/test_weaviate.py::test_weaviate_retriever_search_malformed_response PASSED [ 96%]
tests/test_weaviate.py::test_weaviate_retriever_search_error_handling PASSED [ 96%]
tests/test_weaviate.py::test_weaviate_retriever_with_embed_fn PASSED     [ 96%]
tests/test_weaviate.py::test_weaviate_retriever_weaviate_client_v4 PASSED [ 96%]
tests/test_weaviate_advanced.py::test_weaviate_health_check_success PASSED [ 96%]
tests/test_weaviate_advanced.py::test_weaviate_context_manager PASSED    [ 96%]
tests/test_weaviate_advanced.py::test_weaviate_with_validation PASSED    [ 96%]
tests/test_weaviate_advanced.py::test_weaviate_with_retry PASSED         [ 96%]
tests/test_weaviate_advanced.py::test_weaviate_with_cache PASSED         [ 96%]
tests/test_weaviate_advanced.py::test_weaviate_with_audit_logging PASSED [ 96%]
tests/test_weaviate_advanced.py::test_weaviate_search_failure PASSED     [ 96%]
tests/test_weaviate_advanced.py::test_weaviate_empty_results PASSED      [ 96%]
tests/test_weaviate_advanced.py::test_weaviate_batch_search PASSED       [ 96%]
tests/test_weaviate_advanced.py::test_weaviate_policy_update PASSED      [ 96%]
tests/test_weaviate_advanced.py::test_weaviate_with_embed_fn PASSED      [ 96%]
tests/test_weaviate_advanced.py::test_weaviate_text_query_without_embed_fn PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateFilterBasics::test_simple_equals_condition PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateFilterBasics::test_document_literal_equals PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateFilterBasics::test_multiple_rules_or_logic PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateExistsOperators::test_exists_operator PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateExistsOperators::test_not_exists_operator PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateExistsOperators::test_exists_non_document_field PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateExistsOperators::test_not_exists_non_document_field PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateNotEqualsOperator::test_not_equals_literal PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateNotEqualsOperator::test_not_equals_number PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateInOperator::test_user_in_document_array PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateInOperator::test_user_in_document_array_missing_user_field PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateInOperator::test_literal_in_document_array PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateInOperator::test_document_in_list_literal PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateInOperator::test_document_in_empty_list PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateNotInOperator::test_user_not_in_document_array PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateNotInOperator::test_user_not_in_document_array_missing_user_field PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateNotInOperator::test_literal_not_in_document_array PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateNotInOperator::test_document_not_in_list_literal PASSED [ 97%]
tests/test_weaviate_filter_coverage.py::TestWeaviateNotInOperator::test_document_not_in_empty_list PASSED [ 98%]
tests/test_weaviate_filter_coverage.py::TestWeaviateComplexExpressions::test_or_expression PASSED [ 98%]
tests/test_weaviate_filter_coverage.py::TestWeaviateComplexExpressions::test_and_expression PASSED [ 98%]
tests/test_weaviate_filter_coverage.py::TestWeaviateEdgeCases::test_user_field_missing PASSED [ 98%]
tests/test_weaviate_filter_coverage.py::TestWeaviateEdgeCases::test_default_allow_no_matching_rules PASSED [ 98%]
tests/test_weaviate_filter_coverage.py::TestWeaviateEdgeCases::test_default_deny_no_matching_rules PASSED [ 98%]
tests/test_weaviate_filter_coverage.py::TestWeaviateEdgeCases::test_rule_with_match_conditions PASSED [ 98%]
tests/test_weaviate_filter_coverage.py::TestWeaviateEdgeCases::test_rule_with_match_list_values PASSED [ 98%]
tests/test_weaviate_filter_coverage.py::TestWeaviateEdgeCases::test_everyone_true_no_conditions PASSED [ 98%]
tests/test_weaviate_filter_coverage.py::TestWeaviateValueKeys::test_value_key_for_string PASSED [ 98%]
tests/test_weaviate_filter_coverage.py::TestWeaviateValueKeys::test_value_key_for_int PASSED [ 98%]
tests/test_weaviate_filter_coverage.py::TestWeaviateValueKeys::test_value_key_for_float PASSED [ 98%]
tests/test_weaviate_filter_coverage.py::TestWeaviateValueKeys::test_value_key_for_bool PASSED [ 98%]
tests/test_weaviate_filter_coverage.py::TestWeaviateValueKeys::test_value_key_for_list PASSED [ 98%]
tests/test_weaviate_filter_coverage.py::TestWeaviateCompiledConditions::test_build_from_compiled_condition PASSED [ 98%]
tests/test_weaviate_filter_coverage.py::TestWeaviateCompiledConditions::test_build_from_compiled_in_operator PASSED [ 98%]
tests/test_weaviate_native_or.py::test_weaviate_simple_or_filter PASSED  [ 98%]
tests/test_weaviate_native_or.py::test_weaviate_simple_and_filter PASSED [ 98%]
tests/test_weaviate_native_or.py::test_weaviate_nested_or_and PASSED     [ 98%]
tests/test_weaviate_native_or.py::test_weaviate_three_way_or PASSED      [ 99%]
tests/test_weaviate_native_or.py::test_weaviate_or_with_user_context PASSED [ 99%]
tests/test_weaviate_native_or.py::test_weaviate_complex_nested PASSED    [ 99%]
tests/test_weaviate_native_or.py::test_weaviate_backward_compat_simple_condition PASSED [ 99%]
tests/test_weaviate_native_or.py::test_weaviate_or_with_field_existence PASSED [ 99%]
tests/test_weaviate_native_or.py::test_weaviate_or_with_comparison PASSED [ 99%]
tests/test_weaviate_native_or.py::test_weaviate_or_with_array_operations PASSED [ 99%]
tests/test_weaviate_retriever.py::test_weaviate_retriever_initialization PASSED [ 99%]
tests/test_weaviate_retriever.py::test_weaviate_retriever_missing_dependency PASSED [ 99%]
tests/test_weaviate_retriever.py::test_weaviate_retriever_invalid_client_type PASSED [ 99%]
tests/test_weaviate_retriever.py::test_weaviate_retriever_search_with_filter PASSED [ 99%]
tests/test_weaviate_retriever.py::test_weaviate_retriever_search_admin_access PASSED [ 99%]
tests/test_weaviate_retriever.py::test_weaviate_retriever_no_results PASSED [ 99%]
tests/test_weaviate_retriever.py::test_weaviate_retriever_with_vector_query PASSED [ 99%]
tests/test_weaviate_retriever.py::test_weaviate_retriever_with_custom_properties PASSED [ 99%]
tests/test_weaviate_retriever.py::test_weaviate_retriever_with_additional_metadata PASSED [ 99%]
tests/test_weaviate_retriever.py::test_weaviate_retriever_search_error PASSED [ 99%]
tests/test_weaviate_retriever.py::test_weaviate_retriever_empty_response PASSED [ 99%]
tests/test_weaviate_retriever.py::test_weaviate_retriever_v4_client PASSED [ 99%]
tests/test_weaviate_retriever.py::test_weaviate_retriever_with_certainty PASSED [100%]

=============================== warnings summary ===============================
<frozen importlib._bootstrap>:228
  <frozen importlib._bootstrap>:228: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute

<frozen importlib._bootstrap>:228
  <frozen importlib._bootstrap>:228: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute

<frozen importlib._bootstrap>:228
  <frozen importlib._bootstrap>:228: DeprecationWarning: builtin type swigvarlink has no __module__ attribute

tests/test_langchain_integration.py:59
  /Users/cloud/Programming/ragguard/tests/test_langchain_integration.py:59: LangChainDeprecationWarning: The method `BaseRetriever.get_relevant_documents` was deprecated in langchain-core 0.1.46 and will be removed in 1.0. Use :meth:`~invoke` instead.
    docs = retriever.get_relevant_documents("test query", user=user)

tests/integration/test_concurrent_access.py::test_qdrant_concurrent_queries
  /Users/cloud/Programming/ragguard/tests/integration/test_concurrent_access.py:131: DeprecationWarning: `recreate_collection` method is deprecated and will be removed in the future. Use `collection_exists` to check collection existence and `create_collection` instead.
    client.recreate_collection(

tests/integration/test_concurrent_access.py::test_user_isolation_under_load
  /Users/cloud/Programming/ragguard/tests/integration/test_concurrent_access.py:411: DeprecationWarning: `recreate_collection` method is deprecated and will be removed in the future. Use `collection_exists` to check collection existence and `create_collection` instead.
    client.recreate_collection(

tests/integration/test_faiss_post_filtering.py::test_faiss_post_filtering_returns_correct_count
  /Users/cloud/Programming/ragguard/tests/integration/test_faiss_post_filtering.py:122: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/integration/test_faiss_post_filtering.py::test_faiss_post_filtering_no_leakage
  /Users/cloud/Programming/ragguard/tests/integration/test_faiss_post_filtering.py:164: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/integration/test_faiss_post_filtering.py::test_faiss_post_filtering_all_filtered_out
  /Users/cloud/Programming/ragguard/tests/integration/test_faiss_post_filtering.py:207: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/integration/test_faiss_post_filtering.py::test_faiss_post_filtering_guest_user
  /Users/cloud/Programming/ragguard/tests/integration/test_faiss_post_filtering.py:247: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/integration/test_faiss_post_filtering.py::test_faiss_post_filtering_performance
  /Users/cloud/Programming/ragguard/tests/integration/test_faiss_post_filtering.py:315: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/integration/test_faiss_post_filtering.py::test_faiss_handles_empty_index
  /Users/cloud/Programming/ragguard/tests/integration/test_faiss_post_filtering.py:354: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/integration/test_faiss_post_filtering.py::test_faiss_over_fetching_strategy
  /Users/cloud/Programming/ragguard/tests/integration/test_faiss_post_filtering.py:387: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/integration/test_real_databases.py::test_qdrant_integration
  /Users/cloud/Programming/ragguard/tests/integration/test_real_databases.py:125: DeprecationWarning: `recreate_collection` method is deprecated and will be removed in the future. Use `collection_exists` to check collection existence and `create_collection` instead.
    client.recreate_collection(

tests/test_async_retrievers.py::TestAsyncQdrantSecureRetriever::test_init_requires_async_client
  tests/test_async_retrievers.py:43: PytestWarning: The test <Function test_init_requires_async_client> is marked with '@pytest.mark.asyncio' but it is not an async function. Please remove the asyncio mark. If the test is not marked explicitly, check for global marks applied via 'pytestmark'.
    def test_init_requires_async_client(self):

tests/test_async_retrievers.py::TestAsyncFAISSSecureRetriever::test_wraps_sync_retriever
  /Users/cloud/Programming/ragguard/ragguard/retrievers_async/faiss.py:86: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    self._sync_retriever = FAISSSecureRetriever(

tests/test_faiss_advanced.py::test_faiss_health_check_success
  /Users/cloud/Programming/ragguard/tests/test_faiss_advanced.py:61: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_advanced.py::test_faiss_context_manager
  /Users/cloud/Programming/ragguard/tests/test_faiss_advanced.py:78: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    with FAISSSecureRetriever(

tests/test_faiss_advanced.py::test_faiss_with_validation
  /Users/cloud/Programming/ragguard/tests/test_faiss_advanced.py:93: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_advanced.py::test_faiss_with_retry
  /Users/cloud/Programming/ragguard/tests/test_faiss_advanced.py:138: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_advanced.py::test_faiss_with_cache
  /Users/cloud/Programming/ragguard/tests/test_faiss_advanced.py:158: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_advanced.py::test_faiss_with_audit_logging
  /Users/cloud/Programming/ragguard/tests/test_faiss_advanced.py:198: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_advanced.py::test_faiss_search_failure
  /Users/cloud/Programming/ragguard/tests/test_faiss_advanced.py:220: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_advanced.py::test_faiss_empty_results
  /Users/cloud/Programming/ragguard/tests/test_faiss_advanced.py:236: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_advanced.py::test_faiss_batch_search
  /Users/cloud/Programming/ragguard/tests/test_faiss_advanced.py:263: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_advanced.py::test_faiss_policy_update
  /Users/cloud/Programming/ragguard/tests/test_faiss_advanced.py:286: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_advanced.py::test_faiss_over_fetch_factor
  /Users/cloud/Programming/ragguard/tests/test_faiss_advanced.py:313: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_retriever.py::test_faiss_retriever_initialization
  /Users/cloud/Programming/ragguard/tests/test_faiss_retriever.py:55: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_retriever.py::test_faiss_retriever_search_with_filter
  /Users/cloud/Programming/ragguard/tests/test_faiss_retriever.py:89: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_retriever.py::test_faiss_retriever_insufficient_results
  /Users/cloud/Programming/ragguard/tests/test_faiss_retriever.py:130: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_retriever.py::test_faiss_retriever_padding_indices
  /Users/cloud/Programming/ragguard/tests/test_faiss_retriever.py:155: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_retriever.py::test_faiss_retriever_missing_metadata
  /Users/cloud/Programming/ragguard/tests/test_faiss_retriever.py:185: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_retriever.py::test_faiss_retriever_with_vector_query
  /Users/cloud/Programming/ragguard/tests/test_faiss_retriever.py:210: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_retriever.py::test_faiss_retriever_over_fetch_limit
  /Users/cloud/Programming/ragguard/tests/test_faiss_retriever.py:235: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_retriever.py::test_faiss_retriever_search_error
  /Users/cloud/Programming/ragguard/tests/test_faiss_retriever.py:259: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_retriever.py::test_faiss_retriever_score_conversion
  /Users/cloud/Programming/ragguard/tests/test_faiss_retriever.py:281: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

tests/test_faiss_retriever.py::test_faiss_retriever_min_over_fetch_factor
  /Users/cloud/Programming/ragguard/tests/test_faiss_retriever.py:303: UserWarning: FAISSSecureRetriever uses post-filtering (not native database filtering). This provides security but may return fewer results than requested for restrictive policies. For production at scale, consider Qdrant, pgvector, Pinecone, Weaviate, or ChromaDB which support native filtering.
    retriever = FAISSSecureRetriever(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform darwin, python 3.9.6-final-0 ________________

Name                                             Stmts   Miss  Cover   Missing
------------------------------------------------------------------------------
ragguard/__init__.py                                26      2    92%   147-148
ragguard/audit/__init__.py                           2      0   100%
ragguard/audit/logger.py                            66      5    92%   84-85, 141, 152, 178
ragguard/circuit_breaker.py                        150     32    79%   298-313, 330-345
ragguard/cli.py                                    216     39    82%   47, 49, 98-102, 148-167, 209-212, 402-414, 418
ragguard/config.py                                 100     13    87%   131, 135, 137, 139, 141, 146, 148, 150, 157, 159, 161, 163, 166
ragguard/connection_pool.py                        106     16    85%   86, 88, 90, 97, 103, 130-131, 144-145, 182, 187-190, 222, 237-239
ragguard/constants.py                               63      0   100%
ragguard/errors.py                                  98      0   100%
ragguard/exceptions.py                             108      0   100%
ragguard/filters/__init__.py                         2      0   100%
ragguard/filters/backends/__init__.py               13      0   100%
ragguard/filters/backends/arangodb.py              259     23    91%   157, 160, 169, 195, 206, 244-247, 254, 271, 307, 325, 332-338, 359, 366, 372, 387, 415, 444, 471
ragguard/filters/backends/azure_search.py          155     31    80%   75, 127-130, 141, 167-190, 236-237, 252-253, 290-296, 338, 359-363
ragguard/filters/backends/chromadb.py              231     38    84%   64, 99, 155-158, 167, 175, 181, 197, 225, 237, 244-248, 259, 268, 280, 302, 334, 338-340, 352, 359, 379, 384-388, 394-397, 403, 427, 472, 476, 484
ragguard/filters/backends/elasticsearch.py         131     29    78%   66, 118-122, 132, 158-181, 227-228, 243-244, 260, 270, 283-285, 316
ragguard/filters/backends/milvus.py                192     63    67%   60, 68-71, 90, 98, 100, 103-109, 126, 157-190, 194-212, 254, 276, 280, 311, 316, 344, 355-358, 364, 366, 370
ragguard/filters/backends/neo4j.py                 246     15    94%   182, 208, 219, 270, 288, 319, 338, 345-352, 375, 388, 403, 431, 460
ragguard/filters/backends/neptune.py               257     35    86%   102, 151, 165, 187, 198, 277, 297-304, 322, 329, 335, 348, 372, 397, 465, 482-503
ragguard/filters/backends/pgvector.py              265     56    79%   136, 148, 170, 184, 188-190, 204, 206, 215, 224, 226, 241, 250-251, 331, 339, 345, 359, 367-374, 380, 395-411, 417, 428-444
ragguard/filters/backends/pinecone.py              231     63    73%   53, 62-67, 89, 99, 120, 155-158, 162-167, 170-175, 179-191, 197, 225, 231-240, 244-248, 259, 268, 280, 288-292, 302, 334, 352, 359, 379, 384-388, 394-397, 403, 427, 472, 476, 484
ragguard/filters/backends/qdrant.py                224     47    79%   174, 197, 201, 205-207, 231, 267, 278-287, 293-296, 360-361, 381, 394, 398-408, 421, 455, 465, 477-480, 495, 510, 530-550
ragguard/filters/backends/tigergraph.py            244     22    91%   162, 165, 174, 200, 211, 229, 303, 328-334, 352-356, 364, 371, 377, 390, 414, 440, 464
ragguard/filters/backends/weaviate.py              259     25    90%   140, 179-182, 213, 234, 276, 342, 430, 434-436, 456, 472, 511, 528, 544-548, 561, 613, 659, 663, 677
ragguard/filters/base.py                           149     26    83%   77-81, 88, 95, 97, 99-100, 175, 180, 187, 193, 223, 227-228, 244, 259-260, 266, 272, 278, 291-292, 313, 316, 321, 326
ragguard/filters/builder.py                         14      0   100%
ragguard/filters/cache.py                          119      6    95%   76, 243-247, 348
ragguard/filters/custom.py                         171     13    92%   40, 107, 265, 267, 271, 275, 296, 298, 301-302, 329, 385, 493
ragguard/health.py                                  79     15    81%   249-250, 254-255, 259-260, 296-298, 302-304, 308-310
ragguard/integrations/__init__.py                   50     23    54%   33-35, 45-47, 65-67, 77-79, 95-97, 107-109, 122-124, 140-142
ragguard/integrations/a2a.py                       169    130    23%   53-71, 87-88, 124-128, 142-167, 183, 204-253, 272-314, 371-400, 405-426, 444-450, 458, 463, 479-511, 548, 587-588
ragguard/integrations/aws_bedrock.py                85     14    84%   58, 126, 128-131, 144, 234-246, 385-389
ragguard/integrations/crewai.py                     79      0   100%
ragguard/integrations/langchain.py                 147      6    96%   17-22, 28
ragguard/integrations/langgraph.py                  73     16    78%   24, 124-134, 177-184, 310-318, 348, 381
ragguard/integrations/llamaindex.py                 51      5    90%   198-202
ragguard/integrations/mcp.py                       141     31    78%   145, 216-221, 227-230, 242, 253, 291-334, 450-455, 478-479, 487, 565-567
ragguard/logging.py                                117     19    84%   100-102, 116, 121, 195, 205, 212-213, 325, 336, 381, 409-417
ragguard/plugins/__init__.py                         3      0   100%
ragguard/plugins/base.py                            41      6    85%   43, 79, 91, 104, 113, 170
ragguard/plugins/registry.py                        57     10    82%   147, 192, 197, 202, 207, 212, 217, 222, 227, 232
ragguard/policy/__init__.py                          5      0   100%
ragguard/policy/compiler/__init__.py                 4      0   100%
ragguard/policy/compiler/condition_compiler.py     275     13    95%   76, 237, 260, 268, 294, 324, 445, 545, 552, 557, 562, 649-650
ragguard/policy/compiler/evaluator.py              104     24    77%   66, 98, 136-142, 148-156, 164-170, 176-184, 213, 227-234, 278
ragguard/policy/compiler/models.py                  74      7    91%   63-66, 84, 105, 152
ragguard/policy/engine.py                          325     54    83%   278, 340-341, 358-359, 393-403, 419-420, 431, 493, 508-512, 552-560, 563-571, 574-585, 588-600, 684-686
ragguard/policy/errors.py                           90     22    76%   28, 170-203, 233, 249-250, 253, 260-283
ragguard/policy/explainer.py                       153     25    84%   65-66, 69, 75-78, 82-83, 88, 178, 231, 282, 324-325, 333-340, 359-364
ragguard/policy/models.py                          111      1    99%   117
ragguard/policy/parser.py                           50      1    98%   84
ragguard/policy/resolvers.py                        74      5    93%   43, 64, 114, 273, 275
ragguard/policy/validator.py                       158      5    97%   155, 224, 236, 281, 285
ragguard/retrievers/__init__.py                     16      0   100%
ragguard/retrievers/arangodb.py                     93     30    68%   87-92, 128-146, 160, 199, 207, 251-295, 304, 322, 333-336
ragguard/retrievers/azure_search.py                 57     21    63%   117-118, 175-209
ragguard/retrievers/base.py                        228     25    89%   38, 254-256, 345-352, 418, 447-448, 499, 505-514, 727, 783-785, 886, 896
ragguard/retrievers/chromadb.py                     59      7    88%   188, 198-201, 208-209
ragguard/retrievers/elasticsearch.py                61      7    89%   170, 179-180, 191-192, 203-204
ragguard/retrievers/faiss.py                       101      9    91%   253, 289, 310-312, 320-323
ragguard/retrievers/graph_base.py                   42      4    90%   163, 185, 233, 309
ragguard/retrievers/milvus.py                      128     24    81%   156-169, 235-251, 407-427, 431-432, 439
ragguard/retrievers/neo4j.py                       107      9    92%   93-109
ragguard/retrievers/neptune.py                     177     12    93%   85-87, 134, 199, 215-216, 231, 283, 338, 376-378
ragguard/retrievers/pgvector.py                     94     16    83%   125, 128, 133, 138, 211-213, 258-259, 271-272, 290-291, 296-299
ragguard/retrievers/pinecone.py                     58      8    86%   157, 182, 196, 198, 201-204
ragguard/retrievers/qdrant.py                       44      5    89%   125, 162-163, 169-170
ragguard/retrievers/tigergraph.py                  131      8    94%   90-95, 165, 259, 324
ragguard/retrievers/weaviate.py                     73     17    77%   179-183, 195-201, 210, 212-216
ragguard/retrievers_async.py                         2      2     0%   15-28
ragguard/retrievers_async/__init__.py               12      1    92%   74
ragguard/retrievers_async/base.py                   61     25    59%   99, 151, 189, 199, 222-229, 252-262, 286-292
ragguard/retrievers_async/chromadb.py               36      1    97%   151
ragguard/retrievers_async/faiss.py                  23      0   100%
ragguard/retrievers_async/pgvector.py               22      6    73%   99, 120-129, 140
ragguard/retrievers_async/pinecone.py               32      1    97%   148
ragguard/retrievers_async/qdrant.py                 33      1    97%   83
ragguard/retrievers_async/utils.py                  12      0   100%
ragguard/retrievers_async/weaviate.py               35      2    94%   148, 153
ragguard/retry.py                                  148     11    93%   73, 105, 119-123, 302-303, 389-390
ragguard/types.py                                   61      0   100%
ragguard/utils.py                                  128      5    96%   138, 163, 446-448, 452
ragguard/validation.py                              86      3    97%   166, 306-307
------------------------------------------------------------------------------
TOTAL                                             8772   1291    85%
Coverage HTML written to dir htmlcov
================ 1871 passed, 45 skipped, 37 warnings in 16.17s ================
